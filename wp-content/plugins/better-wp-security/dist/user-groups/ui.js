/*! For license information please see ui.js.LICENSE.txt */
(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[4459,1511],{39788:(t,e,r)=>{"use strict";r.r(e),r.d(e,{BulkSettingField:()=>re,SettingsForm:()=>h,SingleSettingField:()=>ee,store:()=>te,useSettingsDefinitions:()=>d});var s={};r.r(s),r.d(s,{BULK_EDIT_GROUP_SETTING:()=>Et,CREATED_DEFAULT_GROUPS:()=>St,CREATE_LOCAL_GROUP:()=>st,DELETE_LOCAL_GROUP:()=>nt,DELETE_LOCAL_GROUPS:()=>it,EDIT_GROUP:()=>tt,EDIT_GROUP_SETTING:()=>lt,FAILED_SAVE_GROUP:()=>ct,FAILED_SAVE_GROUP_SETTINGS:()=>ft,FINISH_SAVE_GROUP:()=>ut,FINISH_SAVE_GROUP_SETTINGS:()=>gt,MARK_GROUP_FOR_DELETION:()=>ot,RESET_ALL_EDITS:()=>rt,RESET_BULK_GROUP_SETTING_EDIT:()=>ht,RESET_BULK_GROUP_SETTING_EDITS:()=>yt,RESET_EDITS:()=>et,RESET_GROUP_SETTING:()=>dt,SET_BULK_ERRORS:()=>Y,SET_GROUP_ERROR:()=>X,START_SAVE_GROUP:()=>at,START_SAVE_GROUP_SETTINGS:()=>pt,bulkEditGroupSetting:()=>z,createLocalGroup:()=>B,createdDefaultGroups:()=>Q,deleteGroup:()=>F,deleteLocalGroups:()=>j,editGroup:()=>x,editGroupSetting:()=>V,markGroupForDeletion:()=>M,resetAllEdits:()=>C,resetBulkGroupSettingEdit:()=>W,resetBulkGroupSettingEdits:()=>q,resetEdits:()=>Z,saveBulkEdits:()=>$,saveGroup:()=>P,saveGroupAndSettings:()=>J,saveGroupSettings:()=>H,saveGroupSettingsAsBatch:()=>K,saveGroups:()=>N});var n={};r.r(n),r.d(n,{getAvailableGroups:()=>Ht,getBulkErrorsList:()=>$t,getBulkSettingEdit:()=>jt,getBulkSettingEdits:()=>Ft,getBulkSettingValue:()=>Bt,getDirtyGroupSettings:()=>Zt,getDirtyGroups:()=>At,getEditedGroup:()=>Tt,getEditedGroupAttribute:()=>It,getEditedGroupSetting:()=>Pt,getEditedGroupSettings:()=>xt,getEditedGroupsBySetting:()=>Nt,getEditedMatchableLabel:()=>kt,getError:()=>qt,getGroupSettingsEdits:()=>Dt,getGroupsMarkedForDeletion:()=>Wt,getLocalGroupIds:()=>Gt,getMatchableNavIds:()=>zt,getMatchableType:()=>Ot,hasBulkSettingEdits:()=>Mt,hasCreatedDefaultGroups:()=>Jt,hasEdits:()=>wt,isDirty:()=>Ct,isLocalGroup:()=>bt,isSavingBulkEdits:()=>Vt,isSavingGroupOrSettings:()=>Rt,settingHasEdits:()=>Lt});var i={};r.r(i),r.d(i,{getAvailableGroups:()=>Qt});var o=r(65096),a=r.n(o),u=r(48015),c=r(87375);function l(){return l.instance||(l.instance=new(a())({schemaId:"id"}),l.instance.addMetaSchema(r(27171))),l.instance}function d(t={}){const e=l();return(0,u.useSelect)((r=>r(c.store).getSettingDefinitions(e,t)),[e,t])}var p=r(87462),g=r(6293),f=r(92819),E=r(71930);function h({highlight:t,definitions:e,settingComponent:r,...s}){const[n,i]=(t||"").split("/");return(0,g.createElement)("ul",{className:"itsec-user-groups-setting-form"},(0,f.map)(e,(t=>!(0,f.isEmpty)(t.settings)&&(0,g.createElement)("li",{key:t.id,className:"itsec-user-groups-setting-form__module"},(0,g.createElement)(E.X6,{level:3,size:E.yH.NORMAL,variant:E.rK.DARK,weight:E.fs.HEAVY,text:t.title}),(0,f.map)(t.settings,((e,o)=>(0,g.createElement)(r,(0,p.Z)({key:o,definition:e,module:t.id,setting:o,isHighlighted:t.id===n&&o===i},s))))))))}var y=r(94184),S=r.n(y),m=r(64893),_=r(52117),v=r(36058),G=r(95122);const b=(0,_.Z)("div",{target:"e1jr729g2"})("border:1px solid ",(({theme:t})=>t.colors.border.normal),";"),O=(0,_.Z)("div",{target:"e1jr729g1"})("display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1rem;border-bottom:1px solid ",(({theme:t})=>t.colors.border.normal),";"),R=(0,_.Z)("div",{target:"e1jr729g0"})({name:"1dvcxr3",styles:"padding:1rem"});function T({definition:t,children:e}){return(0,g.createElement)(b,null,(0,g.createElement)(O,null,e,(0,g.createElement)(E.zx,{href:"https://go.solidwp.com/security-basic-help-docs",target:"_blank",label:(0,G.__)("View external documentation","better-wp-security"),variant:"tertiary",icon:v.Z,isSmall:!0})),(0,g.createElement)(R,null,(0,g.createElement)(E.xv,{text:t.description,size:E.yH.SMALL})))}var I=r(87514),k=r.n(I),w=r(31511);function A(t="info",e,r={}){return{type:"CREATE_NOTICE",status:t,content:e,options:{context:"ithemes-security",...r}}}const L={API_FETCH:({request:t})=>k()(t).catch(w.xJ),CREATE_NOTICE({status:t,content:e,options:r}){r.autoDismiss&&(r.id=r.id||(0,f.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,u.dispatch)("core/notices").removeNotice(r.id,r.context)),r.autoDismiss)),(0,u.dispatch)("core/notices").createNotice(t,e,r)}};var D=r(91247);const U="ithemes-security/user-groups-editor";function*x(t,e){const r=!(yield u.controls.select(U,"isLocalGroup",t))&&(yield u.controls.select(c.store,"getGroup",t)),s={...(yield u.controls.select(U,"getEditedGroup",t))||{},...e},n=(0,f.pickBy)(s,((t,e)=>!(0,f.isEqual)(r?.[e],t)));yield{type:tt,id:t,edit:n}}function*P(t){const e=yield u.controls.select(U,"getEditedGroup",t);if(!e)return;let r;return yield{type:at,id:t},r=(yield u.controls.select(U,"isLocalGroup",t))?yield u.controls.dispatch(c.store,"createGroup",{...e,id:t}):yield u.controls.dispatch(c.store,"updateGroup",t,e),r instanceof Error?yield{type:ct,id:t,error:r}:(yield{type:ut,id:t,updated:r},yield A("success",(0,G.__)("Saved group.","better-wp-security"),{type:"snackbar"})),r}function*N(t=!0){const e=yield u.controls.select(U,"getLocalGroupIds"),r=yield u.controls.select(U,"getGroupsMarkedForDeletion");if(!0===t?t=[...new Set([...yield u.controls.select(U,"getDirtyGroups"),...e,...r])]:(0,f.isString)(t)&&(t=[t]),!t.length)return[];const s=[],n=[],i=[];for(const o of t){const t=yield u.controls.select(U,"getEditedGroup",o);r.includes(o)?i.push(o):e.includes(o)?n.push({...t,id:o}):s.push({...t,id:o})}const o=yield u.controls.dispatch(c.store,"saveGroups",{create:n,update:s,delete:i});if(o instanceof Error)return yield A("error",(0,G.sprintf)((0,G.__)("Could not save user groups: %s","better-wp-security"),o.message)),o;for(const[t,e]of Object.entries(o.byId))e.status>=400?yield{type:ct,id:t,error:e.body}:yield{type:ut,id:t,updated:e.body};return yield A("success",(0,G.__)("Saved user groups.","better-wp-security"),{type:"snackbar"}),o}function Z(t){return{type:et,id:t}}function C(){return{type:rt}}function M(t){return{type:ot,id:t}}function*F(t){if(yield u.controls.select(U,"isLocalGroup",t))yield{type:nt,id:t};else{const e=yield u.controls.dispatch(c.store,"deleteGroup",t);if(e instanceof Error)return yield{type:X,id:t,error:e},e}yield Z(t),yield{type:X,id:t,error:null}}function j(){return{type:it}}function B(t){return{type:st,id:t||(0,D.Z)()}}function*V(t,e,r,s){const n=!(yield u.controls.select(U,"isLocalGroup",t))&&(yield u.controls.select(c.store,"getGroupSetting",t,e,r));(0,f.isEqual)(n,s)?yield{type:dt,id:t,module:e,setting:r}:yield{type:lt,id:t,module:e,setting:r,value:s}}function*H(t){const e=yield u.controls.select(U,"getGroupSettingsEdits",t);if(!e)return;yield{type:pt,id:t};const r=yield u.controls.dispatch(c.store,"updateGroupSettings",t,e);return r instanceof Error?yield{type:ft,id:t,error:r}:(yield{type:gt,id:t,updated:r},yield A("success",(0,G.__)("Updated group settings.","better-wp-security"),{type:"snackbar"})),r}function*K(t=!0){if(!0===t?t=yield u.controls.select(U,"getDirtyGroupSettings"):(0,f.isString)(t)&&(t=[t]),!t.length)return{responses:[],byId:{}};const e={};for(const r of t)e[r]=yield u.controls.select(U,"getGroupSettingsEdits",r);const r=yield u.controls.dispatch(c.store,"saveGroupSettingsAsBatch",e);if(r instanceof Error)return yield A("error",(0,G.sprintf)((0,G.__)("Could not save user groups: %s","better-wp-security"),r.message)),r;for(const[t,e]of Object.entries(r.byId))e.status>=400?yield{type:ft,id:t,error:e.body}:yield{type:gt,id:t,updated:e.body};return yield A("success",(0,G.__)("Saved user groups.","better-wp-security"),{type:"snackbar"}),r}function z(t,e,r){return{type:Et,module:t,setting:e,value:r}}function W(t,e){return{type:ht,module:t,setting:e}}function q(){return{type:yt}}function*$(t){const e=yield u.controls.select(U,"getBulkSettingEdits"),r=yield u.controls.dispatch(c.store,"patchBulkGroupSettings",t,e);if(r instanceof Error)return yield A("error",r.message),r;if((0,f.map)(r,"status").every((t=>200===t)))return yield A("success",(0,G.__)("Updated group settings.","better-wp-security"),{type:"snackbar"}),yield q(),r;const s=r.filter((({status:t})=>200!==t)).flatMap((({error:t})=>(0,w.NC)(t).getAllErrorMessages()));return yield{type:Y,errors:s},r}function*J(t){if(yield u.controls.select(U,"hasEdits",t)){const e=yield*P(t);if(e instanceof Error)return e}if(yield u.controls.select(U,"settingHasEdits",t)){const e=yield*H(t);if(e instanceof Error)return e}return null}function Q(){return{type:St}}const X="SET_GROUP_ERROR",Y="SET_BULK_ERRORS",tt="EDIT_GROUP",et="RESET_EDITS",rt="RESET_ALL_EDITS",st="CREATE_LOCAL_GROUP",nt="DELETE_LOCAL_GROUP",it="DELETE_LOCAL_GROUPS",ot="MARK_GROUP_FOR_DELETION",at="START_SAVE_GROUP",ut="FINISH_SAVE_GROUP",ct="FAILED_SAVE_GROUP",lt="EDIT_GROUP_SETTING",dt="RESET_GROUP_SETTING",pt="START_SAVE_GROUP_SETTINGS",gt="FINISH_SAVE_GROUP_SETTINGS",ft="FAILED_SAVE_GROUP_SETTINGS",Et="BULK_EDIT_GROUP_SETTING",ht="RESET_BULK_GROUP_SETTING_EDIT",yt="RESET_BULK_GROUP_SETTING_EDITS",St="CREATED_DEFAULT_GROUPS";var mt=r(59588),_t=r.n(mt),vt=r(28306);function Gt(t){return t.localGroupIds}function bt(t,e){return t.localGroupIds.includes(e)}const Ot=(0,u.createRegistrySelector)((t=>(e,r)=>bt(e,r)?"user-group":t(c.store).getMatchableType(r))),Rt=(0,u.createRegistrySelector)((t=>(e,r)=>e.saving.includes(r)||t(c.store).isUpdating(r)||t(c.store).isUpdatingSettings(r)));function Tt(t,e){return t.edits[e]}const It=(0,u.createRegistrySelector)((t=>(e,r,s)=>{const n=(0,f.get)(e,["edits",r,s]);return void 0!==n?n:"new"===r||bt(e,r)?void 0:t(c.store).getGroupAttribute(r,s)})),kt=(0,u.createRegistrySelector)((t=>(e,r)=>"user-group"!==t(U).getMatchableType(r)?t(c.store).getMatchableLabel(r):t(U).getEditedGroupAttribute(r,"label")));function wt(t,e){return t.edits[e]&&!(0,f.isEmpty)(t.edits[e])}const At=(0,vt.Z)((t=>Object.keys(t.edits).filter((e=>!(0,f.isEmpty)(t.edits[e])))),(t=>t.edits));function Lt(t,e){return!!t.settingEdits[e]}function Dt(t,e){return t.settingEdits[e]}const Ut=_t()(((t,e)=>(0,f.merge)({},t,e)),{maxSize:1}),xt=(0,u.createRegistrySelector)((t=>(e,r)=>{const s=bt(e,r)?{}:t(c.store).getGroupSettings(r),n=Dt(e,r);return Ut(s,n)})),Pt=(0,u.createRegistrySelector)((t=>(e,r,s,n)=>{const i=(0,f.get)(e,["settingEdits",r,s,n]);return void 0!==i?i:!bt(e,r)&&t(c.store).getGroupSetting(r,s,n)})),Nt=(0,u.createRegistrySelector)((t=>e=>{const r=t(c.store).getGroupsBySetting();if((0,f.isEmpty)(e.settingEdits)||(0,f.isEmpty)(r))return r;const s=(0,f.cloneDeep)(r);for(const[t,r]of Object.entries(e.settingEdits))for(const[e,n]of Object.entries(r))for(const[r,i]of Object.entries(n))s[e]?.[r]&&(i?s[e][r].push(t):(0,f.pull)(s[e][r],t));return s})),Zt=(0,vt.Z)((t=>Object.keys(t.settingEdits).filter((e=>!(0,f.isEmpty)(t.settingEdits[e])))),(t=>t.settingEdits));function Ct(t,e){return wt(t,e)||Lt(t,e)}function Mt(t){return!(0,f.isEmpty)(t.bulkSettingEdits)}function Ft(t){return t.bulkSettingEdits}function jt(t,e,r){return(0,f.get)(t,["bulkSettingEdits",e,r])}const Bt=(0,u.createRegistrySelector)((t=>(e,r,s,n)=>{const i=jt(e,s,n);if(void 0!==i)return i;if(!r.length)return null;const o=e=>t(c.store).getGroupSetting(e,s,n),a=o(r[0]);return r.every((t=>o(t)===a))?a:null})),Vt=(0,u.createRegistrySelector)((t=>(e,r)=>{const s=Ft(e);return t(c.store).isBulkPatchingSettings(r,s)})),Ht=(0,u.createRegistrySelector)((t=>()=>t(c.store).getGroups("available"))),Kt=_t()(((t,e,r,s)=>{if(e&&!t.length)return null;const[n,i]=(0,f.partition)(t,(t=>"user-group"===t.type));return n.map((t=>t.id)).concat(r).concat(i.map((t=>t.id))).filter((t=>!s.includes(t)))}),{maxSize:1}),zt=(0,u.createRegistrySelector)((t=>()=>{const e=t(c.store).getMatchables(),r=t("core/data").isResolving(c.store,"getMatchables"),s=t(U).getLocalGroupIds(),n=t(U).getGroupsMarkedForDeletion();return Kt(e,r,s,n)}));function Wt(t){return t.markedForDelete}function qt(t,e){return t.errors[e]}function $t(t){return t.bulkErrors}function Jt(t){return t.createdDefaultGroups}function*Qt(){yield u.controls.dispatch(c.store,"query","available",{_embed:1})}const Xt={edits:{},settingEdits:{},bulkSettingEdits:{},localGroupIds:[],saving:[],errors:{},bulkErrors:[],markedForDelete:[],createdDefaultGroups:!1},Yt=(0,u.createReduxStore)(U,{controls:L,actions:s,selectors:n,resolvers:i,reducer:function(t=Xt,e){switch(e.type){case tt:return{...t,edits:{...t.edits,[e.id]:e.edit}};case st:return{...t,localGroupIds:[...t.localGroupIds,e.id]};case nt:return{...t,localGroupIds:t.localGroupIds.filter((t=>t!==e.id))};case it:return{...t,localGroupIds:[]};case at:return{...t,saving:[...t.saving,e.id]};case ct:return{...t,saving:t.saving.filter((t=>t!==e.id)),errors:{...t.errors,[e.id]:e.error}};case ut:return{...t,edits:(0,f.omit)(t.edits,[e.id]),localGroupIds:t.localGroupIds.filter((t=>t!==e.id)),saving:t.saving.filter((t=>t!==e.id)),errors:(0,f.omit)(t.errors,[e.id])};case lt:return{...t,settingEdits:{...t.settingEdits,[e.id]:{...(0,f.get)(t,["settingEdits",e.id],{}),[e.module]:{...(0,f.get)(t,["settingEdits",e.id,e.module],{}),[e.setting]:e.value}}}};case dt:const r={...t,settingEdits:{...t.settingEdits,[e.id]:{...(0,f.get)(t,["settingEdits",e.id],{}),[e.module]:(0,f.omit)((0,f.get)(t,["settingEdits",e.id,e.module],{}),[e.setting])}}};return(0,f.isEmpty)(r.settingEdits[e.id][e.module])&&delete r.settingEdits[e.id][e.module],(0,f.isEmpty)(r.settingEdits[e.id])&&delete r.settingEdits[e.id],r;case gt:return{...t,settingEdits:(0,f.omit)(t.settingEdits,[e.id]),errors:(0,f.omit)(t.errors,[e.id])};case ft:return{...t,errors:{...t.errors,[e.id]:e.error}};case et:return{...t,edits:(0,f.omit)(t.edits,[e.id]),settingEdits:(0,f.omit)(t.settingEdits,[e.id]),markedForDelete:t.markedForDelete.filter((t=>t!==e.id)),localGroupIds:t.localGroupIds.filter((t=>t!==e.id))};case rt:return{...t,edits:{},settingEdits:{},bulkSettingEdits:{},markedForDelete:[],localGroupIds:[]};case Et:return{...t,bulkSettingEdits:{...t.bulkSettingEdits,[e.module]:{...t.bulkSettingEdits[e.module]||{},[e.setting]:e.value}}};case ht:return{...t,bulkSettingEdits:(0,f.omit)(t.bulkSettingEdits,`${e.module}.${e.setting}`)};case yt:return{...t,bulkSettingEdits:{},bulkErrors:[]};case ot:return{...t,markedForDelete:[...t.markedForDelete,e.id]};case X:return{...t,errors:e.error?{...t.errors,[e.id]:e.error}:(0,f.omit)(t.errors,[e.id])};case Y:return{...t,bulkErrors:e.errors};case St:return{...t,createdDefaultGroups:!0};default:return t}},persist:["edits","settingEdits","bulkSettingEdits","localGroupIds","markedForDelete"]});(0,u.register)(Yt);const te=Yt;function ee({groupId:t,module:e,setting:r,definition:s,className:n,isHighlighted:i,disabled:o=!1}){const{value:a}=(0,u.useSelect)((s=>({value:s(te).getEditedGroupSetting(t,e,r)})),[t,e,r]),{editGroupSetting:c}=(0,u.useDispatch)(te);return(0,g.createElement)(T,{definition:s},(0,g.createElement)(m.ToggleControl,{className:S()(n,{"itsec-highlighted-search-result":i}),checked:!0===a,label:s.title,disabled:o,onChange:s=>c(t,e,r,s),__nextHasNoMarginBottom:!0}))}function re({groupIds:t,module:e,setting:r,definition:s,disabled:n=!1}){const{value:i}=(0,u.useSelect)((s=>({value:s(te).getBulkSettingValue(t,e,r)})),[t,e,r]),{bulkEditGroupSetting:o}=(0,u.useDispatch)(te);return(0,g.createElement)(T,{definition:s},(0,g.createElement)(m.CheckboxControl,{checked:!0===i,indeterminate:null==i,label:s.title,disabled:n,onChange:t=>o(e,r,t),__nextHasNoMarginBottom:!0}))}r.p=window.itsecWebpackPublicPath},31511:(t,e,r)=>{"use strict";r.d(e,{sE:()=>I,x4:()=>y,PN:()=>E,pL:()=>R,NC:()=>b,N4:()=>O,g4:()=>P,bK:()=>N,Rg:()=>A,CO:()=>L,AW:()=>w,SU:()=>k,k0:()=>G,ZE:()=>v,UC:()=>D,xJ:()=>T,z8:()=>_,VG:()=>x,Y3:()=>U,bv:()=>m});var s=r(92819),n=r(65096),i=r.n(n),o=r(6293),a=r(73470),u=r(95122),c=r(4942),l=r(13092),d=r(86033);function p(t,e,r){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,r)}var g=new WeakMap,f=new WeakMap;class E{constructor(t=void 0,e=void 0,r=void 0){p(this,g,{writable:!0,value:{}}),p(this,f,{writable:!0,value:{}}),(0,c.Z)(this,"add",((t,e,r)=>((0,d.Z)(this,g)[t]||((0,d.Z)(this,g)[t]=[]),(0,d.Z)(this,g)[t].push(e),r&&((0,d.Z)(this,f)[t]||((0,d.Z)(this,f)[t]=[]),(0,d.Z)(this,f)[t].push(r)),this))),(0,c.Z)(this,"hasErrors",(()=>this.getErrorCodes().length>0)),(0,c.Z)(this,"getErrorCodes",(()=>Object.keys((0,d.Z)(this,g)))),(0,c.Z)(this,"getErrorCode",(()=>this.getErrorCodes()[0])),(0,c.Z)(this,"getErrorMessages",((t=void 0)=>{if(t)return(0,d.Z)(this,g)[t];const e=[];for(const t in(0,d.Z)(this,g))(0,d.Z)(this,g).hasOwnProperty(t)&&e.concat((0,d.Z)(this,g)[t]);return e})),(0,c.Z)(this,"getErrorMessage",((t=void 0)=>(t=t||this.getErrorCode(),this.getErrorMessages(t)[0]))),(0,c.Z)(this,"getErrorData",((t=void 0)=>(t=t||this.getErrorCode(),(0,d.Z)(this,f)[t]))),(0,c.Z)(this,"getAllErrorMessages",(()=>{const t=[];for(const e in(0,d.Z)(this,g))(0,d.Z)(this,g).hasOwnProperty(e)&&t.push(...(0,d.Z)(this,g)[e]);return t})),t&&(e&&((0,d.Z)(this,g)[t]=[e]),r&&((0,d.Z)(this,f)[t]=r))}static fromPHPObject(t){const e=new E;return(0,l.Z)(e,g,t.errors),(0,l.Z)(e,f,t.error_data),e}static fromApiError(t){const e=new E;if((0,d.Z)(e,g)[t.code]=[t.message],(0,d.Z)(e,f)[t.code]=[t.data],t.additional_errors)for(const r of t.additional_errors)(0,d.Z)(e,g)[r.code]=[r.message],r.data&&((0,d.Z)(e,f)||(0,l.Z)(e,f,[]),(0,d.Z)(e,f)[r.code].push(r.data));return e}}class h extends Error{constructor(t,...e){super(t.message||(0,u.__)("An unknown error occurred.","better-wp-security"),...e),Error.captureStackTrace&&Error.captureStackTrace(this,h),this.__response=t;for(const e in t)t.hasOwnProperty(e)&&Object.defineProperty(this,e,{value:t[e],configurable:!0,enumerable:!0,writable:!0})}toString(){return this.__response.toString()}getResponse(){return this.__response}}class y{constructor(t,e,r,s=[],n=[],i=[]){(0,c.Z)(this,"type",void 0),(0,c.Z)(this,"error",void 0),(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"success",void 0),(0,c.Z)(this,"info",void 0),(0,c.Z)(this,"warning",void 0),this.type=t,this.error=e,this.data=r,this.success=s,this.info=n,this.warning=i,Object.seal(this)}isSuccess(){return this.type===y.SUCCESS}static async fromResponse(t){const e=e=>{const r=t.headers?.get(`X-Messages-${e}`);return r?JSON.parse(r):[]},r=204!==t.status&&t.json?await t.json():null,s=b(r),n=s.hasErrors()?y.ERROR:y.SUCCESS,i=e("Success"),o=e("Info"),a=e("Warning");return new y(n,s,r,i,o,a)}}Object.defineProperty(y,"SUCCESS",{value:"success",writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(y,"ERROR",{value:"error",writable:!1,enumerable:!1,configurable:!1});const S=(0,o.createContext)({getUrl(t,e){t="settings"===t?"itsec":"itsec-"+t;const r=(0,a.removeQueryArgs)(document.location.href,...Object.keys((0,a.getQueryArgs)(document.location.href)));return(0,a.addQueryArgs)(r,e?{page:t,path:e}:{page:t})}});function m(t,e){const{getUrl:r}=(0,o.useContext)(S);return r(t,e)}function _(t){if(t<=999)return t.toString();if(t<=9999){const e=(t/1e3).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","k"):`${e}k`}if(t<=99999)return t.toString().substring(0,2)+"k";if(t<=999999)return t.toString().substring(0,3)+"k";if(t<=9999999){const e=(t/1e6).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","m"):`${e}m`}if(t<=99999999)return t.toString().substring(0,2)+"m";if(t<=999999999)return t.toString().substring(0,3)+"m";if(t<=9999999999){const e=(t/1e9).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","b"):`${e}b`}return t}function v(t){if(!(0,s.isPlainObject)(t))return!1;const e=Object.keys(t);return 2===e.length&&e.includes("errors")&&e.includes("error_data")}function G(t){if(!(0,s.isPlainObject)(t))return!1;const e=Object.keys(t);return(3===e.length||4===e.length)&&!(4===e.length&&!e.includes("additional_errors"))&&e.includes("code")&&e.includes("message")&&e.includes("data")}function b(t){return t instanceof E?t:v(t)?E.fromPHPObject(t):G(t)?E.fromApiError(t):new E}function O(t){const e={};for(const[r,s]of t)e[r]=s;return e}function R(t,e){const r=[[],[]];for(const s of t)r[e(s)?0:1].push(s);return r}function T(t){if(t instanceof Error)throw t;throw new h(t)}const I="https://secure.gravatar.com/avatar/d7a973c7dab26985da5f961be7b74480?s=96&d=mm&f=y&r=g";function k(t,e,r=!0){return(0,s.get)(t,["_links","self",0,"targetHints",e],r?void 0:[])}function w(t){return A(t,"self")}function A(t,e){return(0,s.get)(t,["_links",e,0,"href"])}function L(t,e){if(t&&t.links)for(const r of t.links)if(r.rel===e)return r}function D(t,e){if("object"!==t.type)return t;let r;for(const n in e)e.hasOwnProperty(n)&&"hidden"===e[n]["ui:widget"]&&(r||(r=(0,s.cloneDeep)(t)),delete r.properties[n]);return r||t}function U(t){let e=[];if(!t)return e;const r=t instanceof E?t:b((0,s.pick)(t,["code","message","data"]));return"rest_invalid_param"===r.getErrorCode()&&(e=Object.values(r.getErrorData().params)),[...r.getAllErrorMessages(),...e]}function x(t){const e=new Date;if(t>e)return(0,u.__)("Online Recently","better-wp-security");const r=Math.floor((e-t)/1e3);let s=r/31536e3;return s>1?(0,u.sprintf)((0,u.__)("%s years","better-wp-security"),Math.floor(s)):(s=r/2592e3,s>1?(0,u.sprintf)((0,u.__)("%s months","better-wp-security"),Math.floor(s)):(s=r/86400,s>1?(0,u.sprintf)((0,u.__)("%s days","better-wp-security"),Math.floor(s)):(s=r/3600,s>1?(0,u.sprintf)((0,u.__)("%s hours","better-wp-security"),Math.floor(s)):(s=r/60,s>1?(0,u.sprintf)((0,u.__)("%s minutes","better-wp-security"),Math.floor(s)):(0,u.sprintf)((0,u.__)("%s seconds","better-wp-security"),Math.floor(s))))))}function P(){return P.instance||(P.instance=new(i())({schemaId:"id"}),P.instance.addMetaSchema(r(27171)),P.instance.addFormat("html",{type:"string",validate:()=>!0}),P.instance.addFormat("relative-file-path",{type:"string",validate:t=>!t.includes("../")}),P.instance.addFormat("file-path",{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")}),P.instance.addFormat("directory",{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")})),P.instance}function N(t){const e=t.toUpperCase().split("").map((t=>127397+t.charCodeAt()));return String.fromCodePoint(...e)}},36058:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var s=r(6293),n=r(14776);const i=(0,s.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(n.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"}))},94184:(t,e)=>{var r;!function(){"use strict";var s={}.hasOwnProperty;function n(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var i=typeof r;if("string"===i||"number"===i)t.push(r);else if(Array.isArray(r)){if(r.length){var o=n.apply(null,r);o&&t.push(o)}}else if("object"===i)if(r.toString===Object.prototype.toString)for(var a in r)s.call(r,a)&&r[a]&&t.push(a);else t.push(r.toString())}}return t.join(" ")}t.exports?(n.default=n,t.exports=n):void 0===(r=function(){return n}.apply(e,[]))||(t.exports=r)}()},59588:t=>{t.exports=function(t,e){var r,s,n=0;function i(){var i,o,a=r,u=arguments.length;t:for(;a;){if(a.args.length===arguments.length){for(o=0;o<u;o++)if(a.args[o]!==arguments[o]){a=a.next;continue t}return a!==r&&(a===s&&(s=a.prev),a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.next=r,a.prev=null,r.prev=a,r=a),a.val}a=a.next}for(i=new Array(u),o=0;o<u;o++)i[o]=arguments[o];return a={args:i,val:t.apply(null,i)},r?(r.prev=a,a.next=r):s=a,n===e.maxSize?(s=s.prev).next=null:n++,r=a,a.val}return e=e||{},i.clear=function(){r=null,s=null,n=0},i}},28306:(t,e,r)=>{"use strict";var s,n;function i(t){return[t]}function o(){var t={clear:function(){t.head=null}};return t}function a(t,e,r){var s;if(t.length!==e.length)return!1;for(s=r;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}function u(t,e){var r,u;function c(){r=n?new WeakMap:o()}function l(){var r,s,n,i,o,c=arguments.length;for(i=new Array(c),n=0;n<c;n++)i[n]=arguments[n];for(o=e.apply(null,i),(r=u(o)).isUniqueByDependants||(r.lastDependants&&!a(o,r.lastDependants,0)&&r.clear(),r.lastDependants=o),s=r.head;s;){if(a(s.args,i,1))return s!==r.head&&(s.prev.next=s.next,s.next&&(s.next.prev=s.prev),s.next=r.head,s.prev=null,r.head.prev=s,r.head=s),s.val;s=s.next}return s={val:t.apply(null,i)},i[0]=null,s.args=i,r.head&&(r.head.prev=s,s.next=r.head),r.head=s,s.val}return e||(e=i),u=n?function(t){var e,n,i,a,u,c=r,l=!0;for(e=0;e<t.length;e++){if(!(u=n=t[e])||"object"!=typeof u){l=!1;break}c.has(n)?c=c.get(n):(i=new WeakMap,c.set(n,i),c=i)}return c.has(s)||((a=o()).isUniqueByDependants=l,c.set(s,a)),c.get(s)}:function(){return r},l.getDependants=e,l.clear=c,c(),l}r.d(e,{Z:()=>u}),s={},n="undefined"!=typeof WeakMap},91247:(t,e,r)=>{"use strict";var s;r.d(e,{Z:()=>c});var n=new Uint8Array(16);function i(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(n)}for(var o=r(27738),a=[],u=0;u<256;++u)a.push((u+256).toString(16).substr(1));const c=function(t,e,r){var s=(t=t||{}).random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){r=r||0;for(var n=0;n<16;++n)e[r+n]=s[n];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]).toLowerCase();if(!(0,o.Z)(r))throw TypeError("Stringified UUID is invalid");return r}(s)}},27738:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,n=function(t){return"string"==typeof t&&s.test(t)}},87375:t=>{t.exports=function(){return this.itsec["user-groups"].api}()},87514:t=>{t.exports=function(){return this.wp.apiFetch}()},64893:t=>{t.exports=function(){return this.wp.components}()},9576:t=>{t.exports=function(){return this.wp.compose}()},48015:t=>{t.exports=function(){return this.wp.data}()},82521:t=>{t.exports=function(){return this.wp.date}()},6293:t=>{t.exports=function(){return this.wp.element}()},95122:t=>{t.exports=function(){return this.wp.i18n}()},81019:t=>{t.exports=function(){return this.wp.keycodes}()},14776:t=>{t.exports=function(){return this.wp.primitives}()},73470:t=>{t.exports=function(){return this.wp.url}()},99196:t=>{"use strict";t.exports=window.React},92819:t=>{"use strict";t.exports=window.lodash}},t=>{t.O(0,[1930,5307],(()=>(39788,t(t.s=39788))));var e=t.O();((window.itsec=window.itsec||{})["user-groups"]=window.itsec["user-groups"]||{}).ui=e}]);
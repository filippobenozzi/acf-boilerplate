(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[5448],{80072:(e,t,a)=>{"use strict";a.r(t);var r={};a.r(r),a.d(r,{settings:()=>O,slug:()=>N});var n={};a.r(n),a.d(n,{EmptyState:()=>oe,default:()=>de,settings:()=>ue,slug:()=>me});var l=a(6293),s=a(95122),i=a(3571),c=a(48015),o=a(8476),d=a(52117),m=a(59588),u=a.n(m),g=a(82521),p=a(64893),h=a(9576),E=a(71930),x=a(63263),f=a(36179),w=a(60976),v=a(1528);function y({card:e,config:t}){const[a,r]=(0,l.useState)(void 0);return(0,l.createElement)("div",{className:"itsec-card--type-malware-scan itsec-card--type-malware--scan-only"},(0,l.createElement)(v.CardHeader,null,(0,l.createElement)(v.CardHeaderTitle,{card:e,config:t})),(0,l.createElement)("section",{className:"itsec-card-malware-scan__description"},(0,l.createElement)("p",null,(0,l.createInterpolateElement)((0,s.__)("This <a>site scan is powered by SolidWP</a>. We check for Google Safe Browsing blocklist status, website errors, and out-of-date software. These data points are not 100% accurate, but we try our best to provide thorough results.","better-wp-security"),{a:(0,l.createElement)("a",{href:"https://go.solidwp.com/solid-security-site-scanner-help-center"})})),(0,l.createElement)("p",null,(0,s.__)("Enable Database Logging to see a history of completed Site Scans.","better-wp-security"))),(0,l.createElement)(v.CardFooterSchemaActions,{card:e,onComplete:(e,t)=>e.endsWith("/scan")&&r(t)}),a&&(0,l.createElement)(p.Modal,{title:(0,s.__)("Scan Results","better-wp-security"),onRequestClose:()=>r(void 0)},(0,l.createElement)(f.yR,{results:a,showSiteUrl:!1})))}const b=u()(((e,t)=>String(e).replace(/https?:\/\//,"")===String(t).replace(/https?:\/\//,""))),_=(0,d.Z)(E.Tg,{target:"e1rgjaw11"})("display:flex;flex-direction:column;align-items:center;justify-content:center;gap:",(({theme:{getSize:e}})=>e(.5)),";padding:",(({theme:{getSize:e}})=>`${e(1.5)} ${e(.5)}`),";");function L(){return(0,l.createElement)(_,null,(0,l.createElement)(x.nU,{icon:(0,l.createElement)(w.ji,null),isSmall:!0}),(0,l.createElement)(E.xv,{weight:E.fs.HEAVY,text:(0,s.__)("No site scans have been made recently","better-wp-security")}),(0,l.createElement)(E.xv,{align:"center",text:(0,s.__)("Scan your site to see results and details shown here!","better-wp-security")}))}const S=(0,d.Z)(E.xv,{target:"e1rgjaw10"})({name:"1xokprr",styles:"text-align:right!important"});function I({card:e,config:t}){const a=(0,h.useInstanceId)(I),{period:r,siteInfo:n}=(0,c.useSelect)((a=>{var r;return{period:null!==(r=a("ithemes-security/dashboard").getDashboardCardQueryArgs(e.id)?.period)&&void 0!==r?r:t.query_args.period?.default,siteInfo:a("ithemes-security/core").getSiteInfo()}}),[e.id,t]),[i,o]=(0,l.useState)(0),[d,m]=(0,l.useState)(void 0),[u,w]=(0,l.useState)(!1),{queryDashboardCard:y}=(0,c.useDispatch)("ithemes-security/dashboard");return(0,l.createElement)("div",{className:"itsec-card--type-malware-scan"},(0,l.createElement)(v.CardHeader,null,(0,l.createElement)(v.CardHeaderTitle,{card:e,config:t}),(0,l.createElement)(x.kS,{value:r,onChange:t=>y(e.id,{period:t})})),(0,l.createElement)("section",{className:"itsec-card-malware-scan__scans-section"},(0,l.createElement)("table",{className:"itsec-card-malware-scan__scans"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)(E.xv,{as:"th",textTransform:"capitalize",text:(0,s.__)("Date","better-wp-security")}),(0,l.createElement)(E.xv,{as:"th",textTransform:"capitalize",text:(0,s.__)("Scan Status","better-wp-security")}),(0,l.createElement)(S,{as:"th",textTransform:"capitalize",text:(0,s.__)("Actions","better-wp-security")}))),(0,l.createElement)("tbody",null,0===e.data.scans.length?(0,l.createElement)("tr",null,(0,l.createElement)("td",{colSpan:"6"},(0,l.createElement)(L,null))):e.data.scans.map((e=>{const t=e.id,r=e.status,c=e.description;return(0,l.createElement)("tr",{key:t},(0,l.createElement)(E.xv,{as:"th",text:(0,g.dateI18n)("M d, Y g:i A",e.time)}),(0,l.createElement)("td",null,(0,l.createElement)(E.xv,{indicator:()=>"clean"===r?"#7ad03a":"error"===r?"#dd3d36":"#ffb900",text:c})),(0,l.createElement)(S,{as:"td"},(0,l.createElement)(E.zx,{variant:"link","aria-pressed":i===t,onClick:()=>o(t),align:"right"},(0,s.__)("View Results","better-wp-security")),i===t&&(0,l.createElement)(p.Modal,{title:(0,s.sprintf)((0,s.__)("View Scan Details for %s","better-wp-security"),(0,g.dateI18n)("M d, Y g:i A",e.time)),onRequestClose:()=>{o(0),w(!1)},className:"itsec-apply-css-vars"},(0,l.createElement)(f.yR,{results:e,showSiteUrl:!b(e.url,n?.url)}),(0,l.createElement)(E.zx,{className:"itsec-card-malware-scan__raw-details-toggle",variant:"link",onClick:()=>w(!u),"aria-expanded":u,"aria-controls":`itsec-card-malware-scan__raw-details--${a}`},u?(0,s.__)("Hide Raw Details","better-wp-security"):(0,s.__)("Show Raw Details","better-wp-security")),(0,l.createElement)("div",{id:`itsec-card-malware-scan__raw-details--${a}`,style:{visibility:u?"visible":"hidden"}},u&&(0,l.createElement)(f.s8,{json:e})))))}))))),(0,l.createElement)(v.CardFooterSchemaActions,{card:e,onComplete:(e,t)=>e.endsWith("/scan")&&m(t)}),d&&(0,l.createElement)(p.Modal,{title:(0,s.__)("Scan Results","better-wp-security"),onRequestClose:()=>m(void 0),className:"itsec-apply-css-vars"},(0,l.createElement)(f.yR,{results:d,showSiteUrl:!1})))}const N="malware-scan",O={render:e=>"file"===e.card?.data.log_type?(0,l.createElement)(y,e):(0,l.createElement)(I,e)};var z=a(31511),k=a(71941),C=a(36713),Z=a(48562),j=a(27231),q=a(28184);function D(e){switch(e){case"plugin":return k.Z;case"theme":return C.Z;case"core":return Z.Z;default:return}}function A(e){switch(!0){case null===e:return"#CECECE";case e<3:return"#B8E6BF";case e<7:return"#FFC518";case e<9:return"#FFABAF";default:return"#D63638"}}function M(e){switch(e){case"":return(0,l.createElement)(Y,{icon:j.Z,style:{fill:"#D75A4B"}});case"auto-updated":case"deactivated":case"deleted":case"updated":return(0,l.createElement)(K,{icon:q.Z,style:{fill:"#FFFFFF"}});case"patched":return(0,l.createElement)(w.dz,null)}}const T=(0,d.Z)(E.Tg,{target:"e3gj6q020"})("display:flex;flex-direction:column;justify-content:center;align-items:center;padding:",(({theme:{getSize:e}})=>`${e(1.5)} 0`),";gap:",(({theme:{getSize:e}})=>e(.75)),";"),F=(0,d.Z)(E.Tg,{target:"e3gj6q019"})({name:"84kb7r",styles:"display:flex;flex-direction:column;height:100%;container-type:inline-size;overflow:auto"}),H=(0,d.Z)("div",{target:"e3gj6q018"})({name:"isgvpc",styles:"display:flex;flex-direction:column;align-items:flex-end"}),V=(0,d.Z)(H,{target:"e3gj6q017"})({name:"126dg97",styles:"margin-left:1rem;& span{font-size:0.5rem;}& svg{width:100px;}"}),P=(0,d.Z)(E.Tg,{target:"e3gj6q016"})("display:flex;justify-content:flex-end;position:sticky;bottom:0;padding:0.5rem 1.25rem;margin-top:auto;border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";"),R=(0,d.Z)(w.Ie,{target:"e3gj6q015"})({name:"10tz94x",styles:"height:56px;width:56px"}),W=(0,d.Z)(E.xv,{target:"e3gj6q014"})("padding:",(({theme:{getSize:e}})=>`0 ${e(.5)}`),";"),B=(0,d.Z)(E.xv,{target:"e3gj6q013"})("padding:1.5px 6.5px;background-color:",(({backgroundColor:e})=>e),";border-radius:2px;width:35px;display:flex;justify-content:center;"),K=(0,d.Z)(p.Icon,{target:"e3gj6q012"})({name:"1svyz14",styles:"background-color:#438C56;border-radius:2rem"}),Y=(0,d.Z)(p.Icon,{target:"e3gj6q011"})({name:"i7362z",styles:"background-color:#FFABAF;border-radius:2rem"}),$=(0,d.Z)(E.xv,{target:"e3gj6q010"})({name:"104g9nb",styles:"grid-area:name"}),U=(0,d.Z)(E.xv,{target:"e3gj6q09"})({name:"1olbkha",styles:"grid-area:version"}),G=(0,d.Z)(E.xv,{target:"e3gj6q08"})({name:"29p8i5",styles:"grid-area:detail"}),J=(0,d.Z)(E.Tg,{shouldForwardProp:e=>"isWide"!==e,target:"e3gj6q07"})("display:grid;grid-template-columns:",(({isWide:e})=>e?"1fr 1fr 1fr":"1fr 0.5fr 1fr"),";grid-template-areas:",(({isWide:e})=>e?'"name version detail"':'"name name name" "version detail detail"'),";align-items:center;"),Q=(0,d.Z)(E.Tg,{target:"e3gj6q06"})({name:"tsr3y4",styles:"flex-shrink:1;overflow-y:auto;position:relative"}),X=(0,d.Z)(E.xv,{target:"e3gj6q05"})({name:"1ekvb27",styles:"grid-column:2"}),ee=(0,d.Z)(E.xv,{target:"e3gj6q04"})("padding:0.875rem;text-transform:uppercase;background-color:",(({theme:e})=>e.colors.surface.tertiary),";border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),te=(0,d.Z)(E.aV,{target:"e3gj6q03"})("padding:0.5rem 0.25rem 0.5rem 0.5rem;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),ae=(0,d.Z)(E.Tg,{target:"e3gj6q02"})({name:"1iduqfj",styles:"display:grid;align-items:center;grid-template-columns:1fr 1.25fr 0.75fr 1fr;margin-bottom:1rem"}),re=(0,d.Z)(E.Tg,{target:"e3gj6q01"})({name:"18xfe8g",styles:"display:grid;align-items:center;grid-template-columns:1fr 1fr 1fr 1fr"}),ne=(0,d.Z)("a",{target:"e3gj6q00"})({name:"1ytfwhz",styles:"grid-column:4"});function le({cardData:e}){return(0,l.createElement)("div",null,(0,l.createElement)(ee,{as:"p",variant:E.rK.DARK,text:(0,s.__)("Vulnerabilities Overview","better-wp-security")}),(0,l.createElement)(te,null,0===e.vulnerabilities.length?(0,l.createElement)(oe,{date:e.data}):e.vulnerabilities.map((e=>(0,l.createElement)(se,{key:e.id,vulnerability:e})))))}function se({vulnerability:e}){var t;return(0,l.createElement)(E.HC,null,(0,l.createElement)(ae,null,(0,l.createElement)(E.xv,{icon:D(e.software.type.slug),text:e.software.type.label}),"wordpress"!==e.software.type.slug&&(0,l.createElement)(E.xv,{weight:500,text:e.software.label||e.software.slug}),(0,l.createElement)(B,{backgroundColor:A(e.details.score),weight:600,text:null!==(t=e.details.score)&&void 0!==t?t:"??"}),(0,l.createElement)(E.xv,{text:(0,s.sprintf)((0,s.__)("%s ago","better-wp-security"),e.last_seen_diff)})),(0,l.createElement)(re,null,(0,l.createElement)(X,{icon:M(e.resolution.slug),iconSize:16,text:e.resolution.label}),(0,l.createElement)(ne,{href:(0,z.bv)("vulnerabilities",`/vulnerability/${e.id}`)},(0,s.__)("View Details","better-wp-security"))))}function ie({cardData:e,isWide:t}){return(0,l.createElement)(Q,{as:"section"},(0,l.createElement)("table",{className:"itsec-card-vulnerable-software__table"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)(E.xv,{as:"th",text:(0,s.__)("Type","better-wp-security")}),(0,l.createElement)(E.xv,{as:"th",text:(0,s.__)("Vulnerability","better-wp-security")}),(0,l.createElement)(E.xv,{as:"th",text:(0,s.__)("Severity","better-wp-security")}),(0,l.createElement)(E.xv,{as:"th",text:(0,s.__)("Status","better-wp-security")}),(0,l.createElement)(E.xv,{as:"th",text:(0,s.__)("Date","better-wp-security")}),(0,l.createElement)(E.xv,{as:"th",text:(0,s.__)("Action","better-wp-security")}))),(0,l.createElement)("tbody",null,0===e.vulnerabilities.length?(0,l.createElement)("tr",null,(0,l.createElement)("td",{colSpan:"6"},(0,l.createElement)(oe,{date:e.date}))):e.vulnerabilities.map((e=>(0,l.createElement)(ce,{key:e.id,vulnerability:e,isWide:t}))))))}function ce({vulnerability:e,isWide:t}){var a;return(0,l.createElement)("tr",null,(0,l.createElement)("td",null,(0,l.createElement)(E.xv,{icon:D(e.software.type.slug),text:e.software.type.label})),(0,l.createElement)("td",null,(0,l.createElement)(J,{isWide:t},"wordpress"!==e.software.type.slug&&(0,l.createElement)($,{weight:500,text:e.software.label||e.software.slug}),(0,l.createElement)(U,{text:e.details.affected_in}),(0,l.createElement)(G,{text:e.details.type.label}))),(0,l.createElement)("td",null,(0,l.createElement)(B,{backgroundColor:A(e.details.score),weight:600,text:null!==(a=e.details.score)&&void 0!==a?a:"??"})),(0,l.createElement)("td",null,(0,l.createElement)(E.xv,{icon:M(e.resolution.slug),iconSize:16,text:e.resolution.label})),(0,l.createElement)("td",null,(0,l.createElement)(E.xv,{text:(0,s.sprintf)((0,s.__)("%s ago","better-wp-security"),e.last_seen_diff)})),(0,l.createElement)("td",null,(0,l.createElement)("a",{href:(0,z.bv)("vulnerabilities",`/vulnerability/${e.id}`)},(0,s.__)("View Details","better-wp-security"))))}function oe({date:e}){const t=(0,z.bv)("site-scan");return(0,l.createElement)(T,null,(0,l.createElement)(x.nU,{icon:(0,l.createElement)(R,null),isSmall:!0}),(0,l.createElement)(E.xv,{variant:E.rK.DARK,weight:E.fs.HEAVY,text:e?(0,s.__)("No Vulnerabilities Found!","better-wp-security"):(0,s.__)("Waiting for scan results","better-wp-security")}),(0,l.createElement)(W,{align:"center",size:E.yH.SMALL,variant:E.rK.DARK,text:e?(0,s.__)("Your site has been successfully checked against the Patchstack vulnerability database.","better-wp-security"):(0,l.createInterpolateElement)((0,s.__)("Your site hasn’t been scanned yet. Run your first scan from the <a>Site Scans</a> page.","better-wp-security"),{a:(0,l.createElement)("a",{href:t})})}),e&&(0,l.createElement)(E.xv,{size:E.yH.SMALL,variant:E.rK.DARK,text:(0,s.sprintf)((0,s.__)("Last Scan: %s"),(0,g.dateI18n)("M d, Y",e))}))}function de({card:e,config:t,eqProps:a}){const r=a["max-width"]&&a["max-width"].includes("400px"),n=a["min-width"]&&a["min-width"].includes("1220px"),i=r?(0,s.__)("Last scanned on %s.","better-wp-security"):(0,s.__)("This website was last checked against the vulnerability database on %s.","better-wp-security");return(0,l.createElement)(F,null,(0,l.createElement)(v.CardHeader,null,(0,l.createElement)("div",null,(0,l.createElement)(v.CardHeaderTitle,{card:e,config:t}),e.data.date&&(0,l.createElement)(E.xv,{size:E.yH.SMALL,variant:E.rK.MUTED,text:(0,s.sprintf)(i,(0,g.dateI18n)("M d, Y",e.data.date))})),r?(0,l.createElement)(V,null,(0,l.createElement)(E.xv,{weight:600,text:(0,s.__)("Powered by","better-wp-security")}),(0,l.createElement)(w.P_,null)):(0,l.createElement)(H,null,(0,l.createElement)(E.xv,{size:E.yH.SMALL,weight:600,text:(0,s.__)("Powered by","better-wp-security")}),(0,l.createElement)(w.P_,{alt:(0,s.__)("Patchstack","better-wp-security")}))),r?(0,l.createElement)(le,{cardData:e.data}):(0,l.createElement)(ie,{cardData:e.data,isWide:n}),(0,l.createElement)(P,{as:"footer"},(0,l.createElement)(E.zx,{variant:"primary",text:(0,s.__)("View Vulnerabilities","better-wp-security"),href:(0,z.bv)("vulnerabilities")})))}const me="vulnerable-software",ue={render:de,elementQueries:[{type:"width",dir:"max",px:400},{type:"width",dir:"min",px:1220}]};function ge(){const{registerCard:e}=(0,c.useDispatch)("ithemes-security/dashboard");return(0,o.eH)(ge,(()=>[r,n].forEach((({slug:t,settings:a})=>e(t,a))))),null}a.p=window.itsecWebpackPublicPath,(0,s.setLocaleData)({"":{}},"ithemes-security-pro"),(0,i.registerPlugin)("itsec-site-scanner-dashboard",{render:()=>(0,l.createElement)(ge,null)})},36713:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(6293),n=a(14776);const l=(0,r.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(n.Path,{d:"M4 20h8v-1.5H4V20zM18.9 3.5c-.6-.6-1.5-.6-2.1 0l-7.2 7.2c-.4-.1-.7 0-1.1.1-.5.2-1.5.7-1.9 2.2-.4 1.7-.8 2.2-1.1 2.7-.1.1-.2.3-.3.4l-.6 1.1H6c2 0 3.4-.4 4.7-1.4.8-.6 1.2-1.4 1.3-2.3 0-.3 0-.5-.1-.7L19 5.7c.5-.6.5-1.6-.1-2.2zM9.7 14.7c-.7.5-1.5.8-2.4 1 .2-.5.5-1.2.8-2.3.2-.6.4-1 .8-1.1.5-.1 1 .1 1.3.3.2.2.3.5.2.8 0 .3-.1.9-.7 1.3z"}))},27231:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(6293),n=a(14776);const l=(0,r.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(n.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}))},71941:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(6293),n=a(14776);const l=(0,r.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(n.Path,{d:"M10.5 4v4h3V4H15v4h1.5a1 1 0 011 1v4l-3 4v2a1 1 0 01-1 1h-3a1 1 0 01-1-1v-2l-3-4V9a1 1 0 011-1H9V4h1.5zm.5 12.5v2h2v-2l3-4v-3H8v3l3 4z"}))},48562:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(6293),n=a(14776);const l=(0,r.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,r.createElement)(n.Path,{d:"M20 10c0-5.51-4.49-10-10-10C4.48 0 0 4.49 0 10c0 5.52 4.48 10 10 10 5.51 0 10-4.48 10-10zM7.78 15.37L4.37 6.22c.55-.02 1.17-.08 1.17-.08.5-.06.44-1.13-.06-1.11 0 0-1.45.11-2.37.11-.18 0-.37 0-.58-.01C4.12 2.69 6.87 1.11 10 1.11c2.33 0 4.45.87 6.05 2.34-.68-.11-1.65.39-1.65 1.58 0 .74.45 1.36.9 2.1.35.61.55 1.36.55 2.46 0 1.49-1.4 5-1.4 5l-3.03-8.37c.54-.02.82-.17.82-.17.5-.05.44-1.25-.06-1.22 0 0-1.44.12-2.38.12-.87 0-2.33-.12-2.33-.12-.5-.03-.56 1.2-.06 1.22l.92.08 1.26 3.41zM17.41 10c.24-.64.74-1.87.43-4.25.7 1.29 1.05 2.71 1.05 4.25 0 3.29-1.73 6.24-4.4 7.78.97-2.59 1.94-5.2 2.92-7.78zM6.1 18.09C3.12 16.65 1.11 13.53 1.11 10c0-1.3.23-2.48.72-3.59C3.25 10.3 4.67 14.2 6.1 18.09zm4.03-6.63l2.58 6.98c-.86.29-1.76.45-2.71.45-.79 0-1.57-.11-2.29-.33.81-2.38 1.62-4.74 2.42-7.1z"}))},1528:e=>{e.exports=function(){return this.itsec.dashboard.dashboard}()},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},6293:e=>{e.exports=function(){return this.wp.element}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash},76292:e=>{"use strict";e.exports=window.moment}},e=>{e.O(0,[7271,1930,5307,9443,135,976,6179,4498],(()=>(80072,e(e.s=80072))));var t=e.O();((window.itsec=window.itsec||{})["site-scanner"]=window.itsec["site-scanner"]||{}).dashboard=t}]);
(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[662,4498],{12032:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ChildPages:()=>k,ErrorRenderer:()=>Ze,Logo:()=>Fe,Main:()=>ve,Navigation:()=>xe,NavigationFill:()=>Ce,NoticeList:()=>Ve,ONBOARD_STORE_NAME:()=>nr,OnboardBackActionFill:()=>Xe,OnboardEmptyMain:()=>tt,OnboardHeader:()=>qe,OnboardMain:()=>et,OnboardProgress:()=>at,OnboardSiteTypeBeforeFill:()=>gr,Page:()=>T,PrimaryForm:()=>Re,PrimaryFormSection:()=>De,SelectableCard:()=>Ae,Sidebar:()=>B,history:()=>Hn,useConfigContext:()=>G,useCurrentPage:()=>A,useNavigateTo:()=>K,useNavigation:()=>D});var n={};r.r(n),r.d(n,{CLEAR_SITE_TYPE:()=>Tt,CLEAR_VISITED_LOCATIONS:()=>Pt,EDIT_ANSWER:()=>kt,RECEIVE_SITE_TYPE:()=>Nt,RECEIVE_SITE_TYPES:()=>Ot,RECORD_VISITED_LOCATION:()=>Ft,REGISTER_COMPLETION_STEP:()=>Dt,REGISTER_QUESTION_COMPONENT:()=>Rt,SELECT_SITE_TYPE:()=>It,SET_COMPLETION_STEP:()=>Zt,SET_ERROR:()=>At,SET_IS_ANSWERING:()=>Mt,answerQuestion:()=>ft,applyAnswerResponse:()=>Et,clearSiteType:()=>pt,clearVisitedLocations:()=>Lt,completeOnboarding:()=>vt,editAnswer:()=>gt,receiveSiteType:()=>_t,receiveSiteTypes:()=>bt,recordVisitedLocation:()=>St,registerCompletionStep:()=>Ct,registerQuestionComponent:()=>wt,repeatQuestion:()=>ht,resetOnboarding:()=>yt,selectSiteType:()=>mt});var i={};r.r(i),r.d(i,{getAnswerRequest:()=>Kt,getAnswers:()=>jt,getCompletionStep:()=>Xt,getCompletionSteps:()=>Gt,getEditedAnswer:()=>$t,getLastError:()=>Ut,getLastVisitedLocation:()=>Qt,getNextQuestion:()=>zt,getQuestionComponent:()=>Wt,getRestoreSiteTypeRequest:()=>Yt,getSelectedSiteType:()=>Bt,getSelectedSiteTypeId:()=>Vt,getSiteTypes:()=>Ht,isAnswering:()=>qt});var a={};r.r(a),r.d(a,{getNextQuestion:()=>rr,getSelectedSiteType:()=>tr,getSiteTypes:()=>er});var s=r(6293),l=r(95122),o=r(25993),c=r.n(o),d=r(79612),u=r(52117),m=r(16550),p=r(42236),g=r(35800),f=r(18526),h=r(64893),E=r(3571),y=r(71930),v=r(92819),b=r(90071),_=r(99196),x=Object.prototype.hasOwnProperty;function w(e,t,r){for(r of e.keys())if(C(r,t))return r}function C(e,t){var r,n,i;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&C(e[n],t[n]););return-1===n}if(r===Set){if(e.size!==t.size)return!1;for(n of e){if((i=n)&&"object"==typeof i&&!(i=w(t,i)))return!1;if(!t.has(i))return!1}return!0}if(r===Map){if(e.size!==t.size)return!1;for(n of e){if((i=n[0])&&"object"==typeof i&&!(i=w(t,i)))return!1;if(!C(n[1],t.get(i)))return!1}return!0}if(r===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(r===DataView){if((n=e.byteLength)===t.byteLength)for(;n--&&e.getInt8(n)===t.getInt8(n););return-1===n}if(ArrayBuffer.isView(e)){if((n=e.byteLength)===t.byteLength)for(;n--&&e[n]===t[n];);return-1===n}if(!r||"object"==typeof e){for(r in n=0,e){if(x.call(e,r)&&++n&&!x.call(t,r))return!1;if(!(r in t)||!C(e[r],t[r]))return!1}return Object.keys(t).length===n}}return e!=e&&t!=t}var S=r(9576),L=r(48015),O=r(31600);const N=(0,s.createContext)({pages:[],childPages:{},addPage:()=>{},removePage:()=>{},addChildPages:()=>{},removeChildPages:()=>{}});function I({children:e}){const[t,r]=(0,s.useState)([]),[n,i]=(0,s.useState)({}),a=(0,s.useCallback)((e=>{r((t=>{const r=t.findIndex((t=>t.id===e.id));let n;return-1===r?n=[...t,e]:(n=[...t],n[r]=e),(0,v.sortBy)(n,"priority")}))}),[]),l=(0,s.useCallback)((e=>{r((t=>t.filter((t=>t.id!==e))))}),[]),o=(0,s.useCallback)(((e,t)=>{i((r=>({...r,[e]:t})))}),[i]),c=(0,s.useCallback)((e=>{i((t=>(0,v.omit)(t,e)))}),[i]);return(0,s.createElement)(N.Provider,{value:{pages:t,childPages:n,addPage:a,removePage:l,addChildPages:o,removeChildPages:c}},e)}function T({id:e,title:t,icon:r,roots:n=["settings"],priority:i=90,location:a="primary",featureFlag:l,ignore:o,hideFromNav:c,children:d}){const u=(0,s.useContext)(N);return(0,s.useEffect)((()=>(u.addPage({id:e,title:t,icon:r,roots:n,priority:i,location:a,featureFlag:l,ignore:o,hideFromNav:c,render:d}),()=>{u.removePage(e)})),[e,t]),null}function k(e){const{pages:t}=e,r=(0,s.useContext)(N),n=(0,S.useInstanceId)(k,"");var i,a,l,o,c;return i=()=>(r.addChildPages(n,t),()=>{r.removeChildPages(n)}),a=[t],_.useEffect(i,(l=a,o=_.useRef(l),c=_.useRef(0),C(l,o.current)||(o.current=l,c.current+=1),_.useMemo((function(){return o.current}),[c.current]))),null}function M({root:e,location:t}={}){const{featureFlags:r}=(0,L.useSelect)((e=>({featureFlags:e(O.CORE_STORE_NAME).getFeatureFlags()})),[]),{root:n}=(0,m.UO)(),{pages:i}=(0,s.useContext)(N);return i.filter((i=>i.roots.includes(e||n)&&(!t||i.location===t)&&(!i.featureFlag||r.includes(i.featureFlag))))}function A(){const e=M(),{page:t}=(0,m.UO)();return e.find((e=>e.id===t))}function R(){const{childPages:e}=(0,s.useContext)(N);return(0,s.useMemo)((()=>(0,v.flatMap)(e)),[e])}function D(e){const{root:t,page:r,child:n,tab:i}=(0,m.UO)(),a=function(e){const t=M();if(!t.length)return;if(!e)return t[0];const r=t.findIndex((t=>t.id===e));return t[r+1]?.id}(r),s=R().map((e=>e.id)),l=(0,m.k6)();let o,c;if(e){let a,s;for(let t=0;t<e.length;t++)if(e[t]===i){a=e[t-1],s=e[t+1];break}o=a&&`/${t}/${r}/${n}/${a}`,c=s&&`/${t}/${r}/${n}/${s}`}if((!o||!c)&&s){let e,i;for(let t=0;t<s.length;t++)if(s[t]===n){e=s[t-1],i=s[t+1];break}o=o||e&&`/${t}/${r}/${e}`,c=c||i&&`/${t}/${r}/${i}`}return!c&&a&&(c=`/${t}/${a}`),{previous:o,goPrevious(){o&&l.push((0,b.ob)(o))},next:c,goNext(){c&&l.push((0,b.ob)(c))},nextPage:a&&`/${t}/${a}`,goNextPage(){a&&l.push((0,b.ob)(`/${t}/${a}`))}}}N.displayName="PageRegistration";var Z=r(73727),F=r(87462),P=r(94184),H=r.n(P),V=r(8476);function B({className:e,logo:t="color",children:r}){const{root:n}=(0,m.UO)(),[i,a]=(0,s.useState)(!1);return(0,s.createElement)("div",(0,F.Z)({},(0,V.Zk)((()=>i&&a(!1))),{tabIndex:-1,className:H()("itsec-settings-sidebar",e,`itsec-settings-sidebar--root-${n}`,{"itsec-settings-sidebar--expanded":i})}),(0,s.createElement)("div",{className:"itsec-settings-sidebar__inner"},(0,s.createElement)(Z.rU,{to:"/",className:"itsec-settings-sidebar__logo"},(0,s.createElement)(Fe,{style:t})),(0,s.createElement)(h.Button,{icon:"menu-alt2",label:(0,l.__)("Toggle Sidebar","better-wp-security"),className:"itsec-settings-sidebar__toggle",showTooltip:!1,isPressed:i,onClick:e=>{e.currentTarget.focus(),a(!i)},"aria-expanded":i}),r))}var j=r(63263),z=r(27231),$=r(36179),q=r(60976),U=r(31511);const W=(0,s.createContext)({serverType:"",installType:"",onboardComplete:!1});function G(){return(0,s.useContext)(W)}function K(){const e=(0,m.k6)();return(0,s.useCallback)(((t,r="push")=>e[r]((0,b.ob)(t))),[e])}function Y(e,t){const{formData:r,conditionalSchemaBase:n}=(0,L.useSelect)((t=>({formData:t(O.MODULES_STORE_NAME).getEditedSettings(e.id),conditionalSchemaBase:t(O.MODULES_STORE_NAME).getSettingsConditionalSchema(e.id)})),[e.id]),{editSettings:i}=(0,L.useDispatch)(O.MODULES_STORE_NAME),a=t?{...n,properties:(0,v.pickBy)(n.properties,t)}:n,s=!(0,v.every)(a?.properties,(e=>"object"===e.type&&(0,v.isEmpty)(e.properties)));return{schema:a,uiSchema:e.settings?.schema.uiSchema,hasSettings:s,formData:r,setFormData:t=>{i(e.id,t.formData)}}}function Q(e){const{root:t}=(0,m.UO)(),r=(()=>{switch(t){case"import":return e?.settings?.import;case"onboard":return e?.settings?.onboard}})(),n=(0,s.useCallback)(((e,t)=>r.includes(t)),[r]);return{allowedFields:r,filterFields:r&&n}}const X=(0,u.Z)("aside",{target:"e1jck2kg4"})("position:relative;display:flex;flex-direction:column;gap:1rem;background:",(({theme:e})=>e.colors.surface.primary),";padding:1rem 2rem 1rem 1.5rem;justify-content:space-between;align-items:center;overflow:hidden;border-radius:0.25rem;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){flex-direction:row;}"),J=(0,u.Z)("section",{target:"e1jck2kg3"})("display:flex;flex-direction:column;gap:0.625rem;align-items:center;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){align-items:flex-start;}"),ee=(0,u.Z)(y.X6,{target:"e1jck2kg2"})("font-size:1.5rem;text-align:center;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){text-align:left;}"),te=(0,u.Z)("a",{target:"e1jck2kg1"})("display:inline-flex;min-width:max-content;padding:0.75rem 1.75rem;justify-content:center;align-items:center;color:#ffffff;font-size:0.83569rem;text-align:center;text-decoration:none;background:#6817C5;&:hover,&:active,&:focus{background-color:#53129e;color:",(({theme:e})=>e.colors.text.white),";}"),re=(0,u.Z)(h.Button,{target:"e1jck2kg0"})({name:"2ostuf",styles:"position:absolute;top:0;right:0;&:hover,&:active,&:focus{color:#6817c5;}"});function ne(){const[e,t]=(0,V._)("itsecIsSolid"),{installType:r}=G(),n=(0,f.u)(),i=(0,s.useMemo)((()=>({...n,colors:{...n.colors,text:{...n.colors.text,white:"#F9FAF9"}}})),[n]);return e?null:(0,s.createElement)(f.a,{theme:i},(0,s.createElement)(X,null,(0,s.createElement)(q.iO,null),(0,s.createElement)(J,null,(0,s.createElement)(ee,{level:2,weight:700,variant:"dark",size:"extraLarge",text:(0,l.__)("iThemes Security is now Solid Security","better-wp-security")}),(0,s.createElement)(y.xv,{size:"subtitleSmall",weight:500,variant:"dark",text:(0,l.__)("We have been working hard for almost a year to bring you incredible new features in the form of our new and improved brand: SolidWP. Discover what’s new!","better-wp-security")})),(0,s.createElement)($.Xp,null),(0,s.createElement)(re,{label:(0,l.__)("Dismiss","better-wp-security"),icon:z.Z,onClick:()=>t(!0)}),(0,s.createElement)(te,{href:"pro"===r?"https://go.solidwp.com/settings-notification-ithemes-becoming-solidwp":"https://go.solidwp.com/settings-notification-free-ithemes-becoming-solidwp",weight:600},(0,l.__)("Learn more","better-wp-security"))))}var ie=r(65202);const ae=(0,u.Z)("aside",{target:"egcu36m6"})("display:flex;flex-direction:column;position:relative;overflow:hidden;padding:0 2.5rem 0 2.5rem;background:linear-gradient(90deg, #00010C 0%, #8533FF 100%);@media screen and (min-width: ",(({theme:e})=>e.breaks.small),"px){flex-direction:row;justify-content:space-between;gap:60px;}"),se=(0,u.Z)("div",{target:"egcu36m5"})("display:flex;flex-direction:column;align-items:flex-start;justify-content:center;gap:0.5rem;margin-top:2.5rem;@media screen and (min-width: ",(({theme:e})=>e.breaks.small),"px){margin-top:0;}"),le=(0,u.Z)(y.X6,{target:"egcu36m4"})({name:"dvodxn",styles:"font-size:1.625rem;font-family:'PolySans',sans-serif"}),oe=(0,u.Z)(y.xv,{target:"egcu36m3"})({name:"1fmf7g3",styles:"font-size:1.375rem;line-height:1.5rem;font-family:'PolySans',sans-serif"}),ce=(0,u.Z)(h.Button,{target:"egcu36m2"})({name:"jfp1m3",styles:"height:47px;width:200px;margin-top:1.25rem;padding:15px 20px;justify-content:center;font-size:1rem;border-radius:50px;background:#F9FAF9;color:#8533FF"}),de=(0,u.Z)(q.fX,{target:"egcu36m1"})("max-width:245px;margin-top:2rem;margin-right:-1rem;align-self:flex-end;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){margin-top:2rem;}@media screen and (min-width: ",(({theme:e})=>e.breaks.xlarge),"px){margin-top:1.25rem;margin-right:90px;}"),ue=(0,u.Z)(h.Button,{target:"egcu36m0"})({name:"1owrvd2",styles:"position:absolute;top:2px;right:2px;&:hover,&:active,&:focus{color:#6817c5;}& svg{background:white;border-radius:25px;}"}),me=Date.UTC(2023,10,20,0,0,0),pe=Date.UTC(2023,11,4,9,59,59),ge=Date.now();function fe(){const[e,t]=(0,V._)("solidSecurityBFCM2023"),{installType:r}=G(),n=(0,f.u)(),i=(0,s.useMemo)((()=>({...n,colors:{...n.colors,text:{...n.colors.text,white:"#F9FAF9"}}})),[n]);return me>ge||pe<ge||e?null:(0,s.createElement)(f.a,{theme:i},(0,s.createElement)(ae,null,(0,s.createElement)(se,null,(0,s.createElement)(le,{level:2,variant:y.rK.WHITE,weight:y.fs.HEAVY,text:(0,l.__)("Save 40% on SolidWP","better-wp-security")}),(0,s.createElement)(oe,{variant:y.rK.WHITE,text:(0,l.__)("Purchase new products during the Black Friday Sale.")}),(0,s.createElement)(ce,{href:"free"===r?"https://go.solidwp.com/bfcm-go-pro":"https://go.solidwp.com/bfcm-security-pro-solid-suite",weight:500},(0,l.__)("Get Solid Suite","better-wp-security"))),(0,s.createElement)(ue,{label:(0,l.__)("Dismiss","better-wp-security"),icon:ie.Z,onClick:()=>t(!0)}),(0,s.createElement)(de,null)))}const he=(0,u.Z)("div",{target:"e1pas7nv2"})({name:"vgwucc",styles:"display:flex;align-self:center;flex-direction:column;gap:1.25rem;width:100%;max-width:1680px;padding:1.25rem 1.25rem 4rem 1.5rem"}),Ee=(0,u.Z)("main",{target:"e1pas7nv1"})({name:"bjn8wh",styles:"position:relative"}),ye=(0,u.Z)(h.FlexItem,{target:"e1pas7nv0"})("margin-top:",(({isMedium:e})=>e&&"1.25rem"),";width:",(({isMedium:e})=>e&&"10rem"),";");function ve({children:e}){const t=(0,S.useViewportMatch)("medium"),r=(0,s.useRef)(),n=(0,m.TH)();return(0,s.useEffect)((()=>{r.current?.focus(),r.current?.ownerDocument.body.scrollTo(0,0)}),[n]),(0,s.createElement)(React.Fragment,null,(0,s.createElement)(j.Qf,null),(0,s.createElement)(he,null,(0,s.createElement)(ne,null),(0,s.createElement)(fe,null),(0,s.createElement)(y.X6,{level:1,text:(0,l.__)("Settings","better-wp-security"),weight:y.fs.NORMAL}),(0,s.createElement)(h.Flex,{gap:5,align:"start",direction:t?"row":"column"},(0,s.createElement)(ye,{isMedium:t},(0,s.createElement)(xe,{orientation:t?"vertical":"horizontal"})),(0,s.createElement)(h.FlexBlock,null,(0,s.createElement)(Ee,{ref:r,"aria-labelledby":"itsec-page-header"},(0,s.createElement)(g.ErrorBoundary,{FallbackComponent:Ze},e))))))}const be=(0,u.Z)(y.aV,{target:"eq1p6lg1"})({name:"vtxs8z",styles:"margin:1rem"}),_e=(0,u.Z)(y.xv,{target:"eq1p6lg0"})("text-decoration:none;&.active{color:",(({theme:e})=>e.colors.primary.darker20),";}");function xe({orientation:e,children:t}){const r=M({location:"primary"}),{root:n,page:i}=(0,m.UO)();return(0,s.createElement)(y.Rx,{orientation:e},r.map((e=>(0,s.createElement)(s.Fragment,{key:e.id},(0,s.createElement)(Z.OL,{key:e.id,to:`/${n}/${e.id}`,component:(0,V.Sj)(y.Ig)},e.title),e.id===i&&(0,s.createElement)(we,null)))),t)}function we(){const e=R();return e.length?(0,s.createElement)(be,{gap:3},e.map((({title:e,to:t,id:r})=>(0,s.createElement)(y.HC,{key:r},(0,s.createElement)(Z.OL,{to:t,component:(0,V.Sj)(_e),as:"a",text:e,variant:y.rK.MUTED}))))):null}const{Fill:Ce}=(0,h.createSlotFill)("Navigation");var Se=r(63708);const Le=(0,u.Z)("button",{target:"e1bc0q4r6"})("text-decoration:none;margin:0;border:0;padding:0;cursor:pointer;-webkit-appearance:none;background:none;width:100%;&:focus{box-shadow:0 0 0 var(--wp-admin-border-width-focus) ",(({theme:e})=>e.colors.primary.base),";outline:3px solid transparent;}"),Oe=(0,u.Z)(y.X6,{target:"e1bc0q4r5"})({name:"1ce9wo2",styles:"grid-area:title"}),Ne=(0,u.Z)(y.xv,{target:"e1bc0q4r4"})({name:"1x9glg",styles:"grid-area:description"}),Ie=(0,u.Z)(y.Tg,{target:"e1bc0q4r3"})({name:"imqah0",styles:"grid-area:icon;width:4rem;height:3.25rem;display:flex;align-items:center;justify-content:center;border-radius:2px"}),Te=(0,u.Z)(h.Icon,{target:"e1bc0q4r2"})({name:"18b7ufz",styles:"fill:#9675F7"}),ke=(0,u.Z)(h.Icon,{target:"e1bc0q4r1"})({name:"1e03zz3",styles:"grid-area:go;align-self:center"}),Me=(0,u.Z)("div",{target:"e1bc0q4r0"})("background:#f6f7f7;border:1px solid ",(({theme:e})=>e.colors.border.normal),";border-radius:2px;display:",(({direction:e})=>"horizontal"===e?"grid":"flex"),";flex-direction:column;align-items:",(({direction:e})=>"vertical"===e&&"center"),";justify-content:",(({direction:e})=>"vertical"===e&&"center"),';grid-template-areas:"icon title go" "icon description go";grid-template-columns:min-content auto min-content;gap:',(({direction:e})=>"horizontal"===e?"0.5rem 1.25rem":"0.75rem"),";padding:1rem;min-height:",(({direction:e})=>"vertical"===e&&"200px"),";&:hover ",ke,"{fill:",(({theme:e})=>e.colors.primary.darker20),";}&:hover ",Oe,"{color:",(({theme:e})=>e.colors.primary.darker20),";}");function Ae({onClick:e,title:t,description:r,icon:n,direction:i="horizontal",className:a,disabled:l}){return(0,s.createElement)(Le,{onClick:e,className:a,variant:"none",disabled:l},(0,s.createElement)(Me,{direction:i},(0,s.createElement)(Ie,{variant:y.h1.SECONDARY},(0,s.createElement)(Te,{icon:n,size:30})),(0,s.createElement)(Oe,{level:4,size:y.yH.LARGE,weight:y.fs.HEAVY,text:t}),r&&(0,s.createElement)(Ne,{variant:y.rK.MUTED,text:r,align:"vertical"===i?"center":"left"}),"horizontal"===i&&(0,s.createElement)(ke,{icon:Se.Z})))}function Re({onSubmit:e=(()=>{}),id:t,hasPadding:r,children:n,errors:i,apiError:a,className:l}){const o=(0,S.useInstanceId)(Re,"itsec-primary-form");return t=t||o,(0,s.createElement)("div",{className:H()("itsec-primary-form",l,r&&"itsec-primary-form--has-padding")},(0,s.createElement)(j.KM,{errors:i,apiError:a}),(0,s.createElement)("form",{id:t,onSubmit:t=>{t.preventDefault(),e()}},n))}function De({heading:e,className:t,children:r}){return s.Children.toArray(r).some(s.isValidElement)?(0,s.createElement)("div",{className:H()("itsec-primary-form__section",t)},e&&(0,s.createElement)(y.X6,{level:3,variant:y.rK.DARK,size:y.yH.NORMAL,weight:y.fs.HEAVY,className:"itsec-primary-form__section-title"},e),r):null}function Ze({error:e}){const{pathname:t}=(0,m.TH)();return(0,s.createElement)(h.Card,{className:"itsec-error-renderer"},(0,s.createElement)(h.CardBody,null,(0,s.createElement)(j.nU,{icon:(0,s.createElement)(q.gI,null)})),(0,s.createElement)(h.CardFooter,{isShady:!0},(0,l.__)("An unexpected error occurred.","better-wp-security"),(0,s.createElement)($.Xp,null),(0,s.createElement)(h.Button,{variant:"secondary",onClick:()=>window.location.reload()},(0,l.__)("Refresh","better-wp-security")),(0,s.createElement)(h.ClipboardButton,{variant:"primary",text:`Page: ${t}\nError: ${e.stack}`},(0,l.__)("Copy Error","better-wp-security"))))}function Fe({style:e,className:t}){const{installType:r}=G();let n;return n="pro"===r?"white"===e?q.v5:q.Zj:"white"===e?q.CE:q.D5,(0,s.createElement)(n,{className:t})}var Pe=r(25703);const He=(0,u.Z)(h.SnackbarList,{target:"e1ifekm20"})("top:",(({root:e})=>"settings"===e?"-70px":"-10px"),";.components-snackbar-list__notice-container{display:flex;flex-direction:column;align-items:flex-end;}");function Ve({context:e="ithemes-security"}){const{notices:t}=(0,L.useSelect)((t=>({notices:t(Pe.store).getNotices(e)})),[e]),{removeNotice:r}=(0,L.useDispatch)(Pe.store),n=t=>r(t,e),{root:i}=(0,m.UO)(),a=(0,v.filter)(t,(e=>e.isDismissible&&(!e.type||"default"===e.type))),l=(0,v.filter)(t,(e=>!(e.isDismissible||e.type&&"default"!==e.type))),o=(0,v.filter)(t,{type:"snackbar"});return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(h.NoticeList,{notices:l}),(0,s.createElement)(h.NoticeList,{notices:a,onRemove:n}),(0,s.createElement)(He,{root:i,notices:o,onRemove:n}))}const Be=(0,u.Z)("header",{target:"e142nzcb3"})({name:"9hhwv0",styles:'display:grid;grid-template-areas:"title action" "description action";grid-gap:0.5rem 1rem;margin-bottom:1.5rem'}),je=(0,u.Z)(y.X6,{target:"e142nzcb2"})({name:"5uk9le",styles:"grid-area:title;display:flex;gap:0.5rem"}),ze=(0,u.Z)(y.xv,{target:"e142nzcb1"})({name:"1x9glg",styles:"grid-area:description"}),$e=(0,u.Z)(y.zx,{target:"e142nzcb0"})({name:"5xe988",styles:"grid-area:action;align-self:end;justify-self:end"});function qe({title:e,description:t,showIndicator:r,showNext:n}){const{page:i}=(0,m.UO)(),{goNext:a}=D(),o=M({location:"primary"}).filter((({hideFromNav:e})=>!e)).findIndex((({id:e})=>e===i))+1;return(0,s.createElement)(Be,null,(0,s.createElement)(je,{level:2,size:y.yH.EXTRA_LARGE,variant:y.rK.DARK,text:e},o&&r&&(0,s.createElement)(y.OR,{step:o,surfaceVariant:y.h1.PRIMARY_ACCENT,textSize:y.yH.NORMAL})),(0,s.createElement)(ze,{as:"p",variant:y.rK.MUTED,text:t}),n&&(0,s.createElement)($e,{onClick:a,variant:"secondary",text:(0,l.__)("Next","better-wp-security")}))}var Ue=r(52278);const We=(0,u.Z)(y.Tg,{target:"eh4epfs3"})({name:"1xqx6nt",styles:"position:relative;height:auto;flex-grow:1;display:flex;flex-direction:column;align-items:start;gap:2rem;padding:1.25rem"}),Ge=(0,u.Z)("main",{target:"eh4epfs2"})({name:"66fm4m",styles:"position:relative;width:100%;align-self:center;display:flex;flex-direction:column;flex-grow:1;align-items:center;justify-content:center"}),Ke=(0,u.Z)(Qe,{target:"eh4epfs1"})({name:"1uuv4to",styles:"position:absolute;top:0;right:0;pointer-events:none"}),Ye=(0,u.Z)(j.TR,{target:"eh4epfs0"})({name:"19c0s48",styles:"height:44px;width:auto"});function Qe({className:e}){return(0,s.createElement)("svg",{className:e,width:"579",height:"503",viewBox:"0 0 579 503",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("g",{opacity:"0.6",filter:"url(#filter0_bf_5527_127309)"},(0,s.createElement)("ellipse",{cx:"579",cy:"-56.5",rx:"259",ry:"239.5",fill:"#53129E"})),(0,s.createElement)("defs",null,(0,s.createElement)("filter",{id:"filter0_bf_5527_127309",x:"0",y:"-616",width:"1158",height:"1119",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},(0,s.createElement)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,s.createElement)("feGaussianBlur",{in:"BackgroundImageFix",stdDeviation:"20"}),(0,s.createElement)("feComposite",{in2:"SourceAlpha",operator:"in",result:"effect1_backgroundBlur_5527_127309"}),(0,s.createElement)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_backgroundBlur_5527_127309",result:"shape"}),(0,s.createElement)("feGaussianBlur",{stdDeviation:"160",result:"effect2_foregroundBlur_5527_127309"}))))}const{Fill:Xe,Slot:Je}=(0,h.createSlotFill)("OnboardBackAction");function et({url:e,render:t}){const{page:r}=(0,m.UO)(),n=function(e){const t=M();if(!t.length)return;if(!e)return;const r=t.findIndex((t=>t.id===e));return t[r-1]?.id}(r),{pathname:i}=(0,m.TH)();return(0,s.createElement)(We,null,(0,s.createElement)(Ke,null),"/onboard/site-type"!==i&&"/onboard/summary"!==i&&(0,s.createElement)(React.Fragment,null,(0,s.createElement)(Ye,null),(0,s.createElement)(Je,null,(t=>t.length>0?t:(0,s.createElement)(Z.rU,{to:n?`${e}/${n}`:e,component:(0,V.Sj)(y.zx),text:(0,l.__)("Back","better-wp-security"),icon:Ue.Z,iconPosition:"left",variant:"tertiary"})))),(0,s.createElement)(Ge,null,(0,s.createElement)(Ve,null),(0,s.createElement)(t,null)),(0,s.createElement)(at,null))}function tt(){return(0,s.createElement)(We,null,(0,s.createElement)(Ge,null))}const rt=(0,u.Z)("div",{target:"e15ke12s2"})({name:"1jx74mh",styles:"display:flex;flex-direction:column;align-items:center;gap:0.5rem;margin-top:auto;align-self:center"}),nt=(0,u.Z)("ul",{target:"e15ke12s1"})({name:"1ik4a25",styles:"display:flex;gap:1.5rem;justify-content:center;align-items:center;margin:0;padding:0"}),it=(0,u.Z)(y.xv,{target:"e15ke12s0"})({name:"b49vxh",styles:"display:inline-flex;align-items:center;gap:0.25rem"});function at({className:e}){const{page:t}=(0,m.UO)(),r=(0,S.useViewportMatch)("medium"),n=M({location:"primary"}).filter((({hideFromNav:e})=>!e));return n.find((({id:e})=>e===t))?(0,s.createElement)(rt,{className:e},(0,s.createElement)(nt,null,n.map(((e,i)=>(r||e.id===t||n[i-1]?.id===t)&&(0,s.createElement)(it,{key:e.id,as:"li",decoration:"none",weight:t===e.id?y.fs.HEAVY:y.fs.NORMAL,variant:t===e.id?y.rK.DARK:y.rK.MUTED},(0,s.createElement)(y.OR,{step:i+1,textSize:y.yH.NORMAL,surfaceVariant:t===e.id?y.h1.PRIMARY_ACCENT:y.h1.SECONDARY}),e.title)))),!r&&(0,s.createElement)(y.xv,{variant:y.rK.MUTED,text:(0,l.sprintf)((0,l.__)("out of %d","better-wp-security"),n.length)})):null}var st=r(87514),lt=r.n(st),ot=r(54761);function ct(e){return{type:"API_FETCH",request:e}}function dt(e,...t){return{type:"DO_ACTION",action:e,args:t}}const ut={AWAIT_PROMISE:({promise:e,delay:t})=>{return t?Promise.all([e,(r=t,new Promise((e=>setTimeout(e,r))))]):e;var r},DO_ACTION:(0,L.createRegistryControl)((e=>({action:t,args:r})=>{(0,ot.doAction)(`ithemes-security.${t}`,e,...r)})),API_FETCH:({request:e})=>lt()(e).catch(U.xJ),CREATE_NOTICE:(0,L.createRegistryControl)((e=>({status:t,content:r,options:n})=>{n.autoDismiss&&(n.id=n.id||(0,v.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>e.dispatch("core/notices").removeNotice(n.id,n.context)),n.autoDismiss)),e.dispatch("core/notices").createNotice(t,r,n)}))};function*mt(e){const t=yield L.controls.resolveSelect(nr,"getSiteTypes"),r=(0,v.find)(t,(t=>t.id===e));if(!r)throw(0,l.__)("No site type found with that id.","better-wp-security");yield _t(r),yield yt()}function pt(){return{type:Tt}}function gt(e){return{type:kt,answer:e}}function*ft(e){const t=yield L.controls.select(nr,"getAnswerRequest",e);let r;yield xt();try{r=yield ct({method:"PUT",path:`/ithemes-security/v1/site-types/${t.id}`,data:t}),yield _t(r)}catch(e){yield(n=e,{type:At,error:n})}var n;yield xt(!1)}function*ht(){const e=yield L.controls.select(nr,"getRestoreSiteTypeRequest");e.answers.pop(),yield xt();const t=yield ct({method:"PUT",path:`/ithemes-security/v1/site-types/${e.id}`,data:e});yield _t(t),yield xt(!1)}function*Et(){const e=yield L.controls.select(nr,"getAnswers"),t=yield L.controls.resolveSelect(O.MODULES_STORE_NAME,"getModules");for(const r of e){for(const e of r.modules){const r=t.find((({id:t})=>t===e));r?.side_effects?yield L.controls.dispatch(O.MODULES_STORE_NAME,"activateModule",e):yield L.controls.dispatch(O.MODULES_STORE_NAME,"editModule",e,{status:{selected:"active"}})}for(const e in r.settings)r.settings.hasOwnProperty(e)&&(yield L.controls.dispatch(O.MODULES_STORE_NAME,"editSettings",e,r.settings[e]));yield dt("onboard.applyAnswerResponse",r)}}function*yt(){yield gt(null),yield L.controls.dispatch(O.MODULES_STORE_NAME,"resetModuleEdits"),yield L.controls.dispatch(O.MODULES_STORE_NAME,"resetSettingEdits"),yield dt("onboard.reset")}function*vt({root:e}){const t=e=>{if(e instanceof Error)throw e},r=(0,v.sortBy)(yield L.controls.select(nr,"getCompletionSteps"),"priority");try{for(const a of r){if(a.activeCallback&&!a.activeCallback({root:e}))continue;yield{type:Zt,step:a};const r=a.callback();r instanceof Promise&&t(yield(n=r,i=(0,v.random)(1500,2500),{type:"AWAIT_PROMISE",promise:n,delay:i}))}yield L.controls.dispatch(O.MODULES_STORE_NAME,"editSetting","global","onboard_complete",!0),yield L.controls.dispatch(O.MODULES_STORE_NAME,"saveSettings","global"),yield{type:Zt,step:!0}}catch(e){yield{type:Zt,step:!1},yield function(e="info",t,r={}){return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}("error",(0,l.sprintf)((0,l.__)("Could not complete setup: %s","better-wp-security"),e.message))}var n,i}function bt(e){return{type:Ot,siteTypes:e}}function _t(e){return{type:Nt,siteType:e}}function xt(e=!0){return{type:Mt,isAnswering:e}}function wt(e,t){return{type:Rt,id:e,component:t}}function Ct({id:e,label:t,priority:r,callback:n,activeCallback:i}){return{type:Dt,id:e,label:t,priority:r,callback:n,activeCallback:i}}function St(e){return{type:Ft,location:(0,v.trimEnd)(e,"/")}}function Lt(){return{type:Pt}}const Ot="RECEIVE_SITE_TYPES",Nt="RECEIVE_SITE_TYPE",It="SELECT_SITE_TYPE",Tt="CLEAR_SITE_TYPE",kt="EDIT_ANSWER",Mt="SET_IS_ANSWERING",At="SET_ERROR",Rt="REGISTER_QUESTION_COMPONENT",Dt="REGISTER_COMPLETION_STEP",Zt="SET_COMPLETION_STEP",Ft="RECORD_VISITED_LOCATION",Pt="CLEAR_VISITED_LOCATIONS";function Ht(e){return e.siteTypes}function Vt(e){return e.selectedSiteType}function Bt(e){return(0,v.find)(Ht(e),{id:Vt(e)})}function jt(e){return e.answers}function zt(e){return e.nextQuestion}function $t(e){return e.editedAnswer}function qt(e){return e.isAnswering}function Ut(e){return e.lastError}function Wt(e,t){return e.questionComponents[t]}function Gt(e){return e.completionSteps}function Kt(e,t){return{id:e.selectedSiteType,answers:[...e.answers,{question:e.nextQuestion.id,answer:t}]}}function Yt(e){return{id:e.selectedSiteType,answers:[...e.answers]}}function Qt(e){const t=["/onboard","/onboard/site-type"];for(let r=e.visitedLocations.length-1;r>=0;r--){const n=e.visitedLocations[r];if(!t.includes(n))return n}}function Xt(e){return e.completionStep}const Jt={siteTypes:[],selectedSiteType:"",answers:[],nextQuestion:void 0,editedAnswer:void 0,lastError:void 0,isAnswering:!1,questionComponents:{},completionStep:!1,completionSteps:{},visitedLocations:[]},er={*fulfill(){const e=yield ct({path:"/ithemes-security/v1/site-types"});yield bt(e)},isFulfilled:e=>e.siteTypes.length>0},tr={*fulfill(){yield L.controls.resolveSelect(nr,"getSiteTypes")},isFulfilled:e=>e.siteTypes.length>0},rr={*fulfill(){const e=yield L.controls.select(nr,"getRestoreSiteTypeRequest"),t=yield ct({method:"PUT",path:`/ithemes-security/v1/site-types/${e.id}`,data:e});yield _t(t)},isFulfilled:e=>void 0!==e.nextQuestion},nr="ithemes-security/onboard";(0,L.registerStore)(nr,{controls:ut,actions:n,selectors:i,resolvers:a,reducer:function(e=Jt,t){switch(t.type){case Ot:return{...e,siteTypes:t.siteTypes};case Nt:return{...e,selectedSiteType:t.siteType.id,nextQuestion:t.siteType.next_question,answers:t.siteType.answers,editedAnswer:t.siteType.next_question?.answer_schema?.default,lastError:void 0};case It:return{...e,selectedSiteType:t.id,answers:[],nextQuestion:void 0,lastError:void 0};case Tt:return{...e,selectedSiteType:"",answers:[],nextQuestion:void 0,lastError:void 0};case kt:return{...e,editedAnswer:t.answer};case Mt:return{...e,isAnswering:t.isAnswering};case At:return{...e,lastError:t.error};case Zt:return{...e,completionStep:t.step};case Rt:return{...e,questionComponents:{...e.questionComponents,[t.id]:t.component}};case Dt:return{...e,completionSteps:{...e.completionSteps,[t.id]:(0,v.omit)(t,["type"])}};case Ft:return{...e,visitedLocations:(0,v.last)(e.visitedLocations)===t.location?e.visitedLocations:(0,v.without)(e.visitedLocations,t.location).concat(t.location)};case Pt:return{...e,visitedLocations:[]};default:return e}},persist:["selectedSiteType","answers","visitedLocations"]});const ir=(0,u.Z)("div",{target:"e16j7rt12"})({name:"1nnaomw",styles:"display:flex;flex-direction:column;gap:1.25rem;max-width:670px"}),ar=(0,u.Z)(j.TR,{target:"e16j7rt11"})({name:"aerlcf",styles:"height:44px;width:auto;align-self:start"}),sr=(0,u.Z)("header",{target:"e16j7rt10"})({name:"p5tmle",styles:"display:flex;flex-direction:column;gap:0.5rem"}),lr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M9 4C8.44531 4 8 4.44531 8 5V6H3C2.44531 6 2 6.44531 2 7V23C2 23.5547 2.44531 24 3 24H8V25C8 25.5547 8.44531 26 9 26H23C23.5547 26 24 25.5547 24 25V24H29C29.5547 24 30 23.5547 30 23V7C30 6.44531 29.5547 6 29 6H24V5C24 4.44531 23.5547 4 23 4H9ZM10 6H22V24H10V6ZM4 8H8V22H4V8ZM12 8V10H20V8H12ZM24 8H28V22H24V8ZM12 12V14H20V12H12ZM12 16V18H20V16H12ZM12 20V22H20V20H12Z",fill:"#9675F7"})),or=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("g",{clipPath:"url(#clip0_5527_131266)"},(0,s.createElement)("path",{d:"M8.94922 4C7.30416 4 5.94922 5.35494 5.94922 7V25C5.94922 26.6451 7.30416 28 8.94922 28H14V26H8.94922C8.38628 26 7.94922 25.5629 7.94922 25V7C7.94922 6.43706 8.38628 6 8.94922 6H17.9492V12H23.9492V14H25.9492V10.5859L19.3633 4H8.94922ZM19.9492 7.41406L22.5352 10H19.9492V7.41406ZM28.3633 16.0078C27.7056 16.012 27.0494 16.2678 26.5586 16.7695L17.3125 26.1758L15.9023 32.1016L21.8242 30.6914L22.0234 30.4961L31.2344 21.4492C32.2423 20.4642 32.2502 18.8167 31.2539 17.8203L30.1836 16.75C29.685 16.2514 29.0239 16.0036 28.3633 16.0078ZM28.375 17.9961C28.5143 17.9952 28.6561 18.0506 28.7695 18.1641L29.8398 19.2344C30.0634 19.458 30.0641 19.7966 29.8359 20.0195V20.0234L20.8242 28.8711L18.6016 29.4023L19.1289 27.1836L27.9844 18.1719L27.9883 18.168C28.0988 18.0542 28.2357 17.997 28.375 17.9961Z",fill:"#9675F7"})),(0,s.createElement)("defs",null,(0,s.createElement)("clipPath",{id:"clip0_5527_131266"},(0,s.createElement)("rect",{width:"32",height:"32",fill:"white"})))),cr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M8 0C6.90625 0 6 0.90625 6 2V11C6 11.5547 6.44531 12 7 12H23C23.5547 12 24 11.5547 24 11V2C24 0.90625 23.0938 0 22 0H8ZM8 4H22V10H8V4ZM8.46875 14L4.86719 20H7.20313L10.7969 14H8.46875ZM14 14V20H16V14H14ZM19.2031 14L22.8047 20H25.1328L21.5312 14H19.2031ZM2 22C0.898438 22 0 22.8984 0 24V28C0 29.1016 0.898438 30 2 30H6C7.10156 30 8 29.1016 8 28V24C8 22.8984 7.10156 22 6 22H2ZM12 22C10.8984 22 10 22.8984 10 24V28C10 29.1016 10.8984 30 12 30H18C19.1016 30 20 29.1016 20 28V24C20 22.8984 19.1016 22 18 22H12ZM24 22C22.8984 22 22 22.8984 22 24V28C22 29.1016 22.8984 30 24 30H28C29.1016 30 30 29.1016 30 28V24C30 22.8984 29.1016 22 28 22H24ZM2 24H6V28H2V24ZM12 24H18V28H12V24ZM24 24H28V28H24V24Z",fill:"#9675F7"})),dr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M13 2C11.3549 2 10 3.35494 10 5V6H5C3.35494 6 2 7.35494 2 9V25C2 26.6451 3.35494 28 5 28H27C28.6451 28 30 26.6451 30 25V9C30 7.35494 28.6451 6 27 6H22V5C22 3.35494 20.6451 2 19 2H13ZM13 4H19C19.5629 4 20 4.43706 20 5V6H12V5C12 4.43706 12.4371 4 13 4ZM5 8H27C27.5629 8 28 8.43706 28 9V25C28 25.5629 27.5629 26 27 26H5C4.43706 26 4 25.5629 4 25V9C4 8.43706 4.43706 8 5 8ZM16 10C14.75 10 13.6872 10.5048 13.0039 11.2734C12.3206 12.0421 12 13.0278 12 14C12 14.9722 12.3206 15.9579 13.0039 16.7266C13.1446 16.8849 13.4498 16.8545 13.6211 16.9883C11.6082 17.9589 10 19.6245 10 22H12C12 19.7782 13.7782 18 16 18C18.2218 18 20 19.7782 20 22H22C22 19.6245 20.3918 17.9589 18.3789 16.9883C18.5502 16.8545 18.8554 16.8849 18.9961 16.7266C19.6794 15.9579 20 14.9722 20 14C20 13.0278 19.6794 12.0421 18.9961 11.2734C18.3128 10.5048 17.25 10 16 10ZM16 12C16.75 12 17.1872 12.2452 17.5039 12.6016C17.8206 12.9579 18 13.4722 18 14C18 14.5278 17.8206 15.0421 17.5039 15.3984C17.1872 15.7548 16.75 16 16 16C15.25 16 14.8128 15.7548 14.4961 15.3984C14.1794 15.0421 14 14.5278 14 14C14 13.4722 14.1794 12.9579 14.4961 12.6016C14.8128 12.2452 15.25 12 16 12Z",fill:"#9675F7"})),ur=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M16.0016 2C12.7047 2 10.0016 4.70313 10.0016 8H6.00157C5.47032 8 5.03282 8.41406 5.00157 8.94531L4.00157 26.9453C3.98595 27.2188 4.08751 27.4922 4.27501 27.6875C4.46251 27.8906 4.72813 28 5.00157 28H27.0016C27.275 28 27.5406 27.8906 27.7281 27.6875C27.9156 27.4922 28.0172 27.2188 28.0016 26.9453L27.0016 8.94531C26.9703 8.41406 26.5328 8 26.0016 8H22.0016C22.0016 4.70313 19.2984 2 16.0016 2ZM16.0016 4C18.2047 4 20.0016 5.79688 20.0016 8H12.0016C12.0016 5.79688 13.7984 4 16.0016 4ZM6.94688 10H10.0016V14H12.0016V10H20.0016V14H22.0016V10H25.0563L25.9391 26H6.06407L6.94688 10Z",fill:"#9675F7"})),mr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M17 2C15.625 2 14.4688 2.95313 14.1172 4.21875C13.7734 4.07813 13.3906 4 13 4C11.3516 4 10 5.35156 10 7V17L7.89063 16.1406L7.84375 16.125C6.25781 15.6641 4.57813 16.5781 4.125 18.1562C4.03906 18.4375 4 18.7188 4 19C4 20.2578 4.80469 21.3047 5.89063 22.0078L5.8125 21.9531L10.125 25.3984C11.7656 26.8047 13.6641 28 16 28H20C24.375 28 28 24.4297 28 20.0391V9C28 7.35156 26.6484 6 25 6C24.6484 6 24.3125 6.07813 24 6.1875V6C24 4.35156 22.6484 3 21 3C20.4297 3 19.8984 3.17188 19.4453 3.45313C19.0234 2.89844 18.4062 2.47656 17.6875 2.28125C17.5 2.10938 17.2578 2.00781 17 2ZM17 4C17.5625 4 18 4.4375 18 5V14H20V6C20 5.4375 20.4375 5 21 5C21.5625 5 22 5.4375 22 6V14H24V9C24 8.4375 24.4375 8 25 8C25.5625 8 26 8.4375 26 9V20.0391C26 23.3281 23.2969 26 20 26H16C14.3438 26 12.9219 25.1562 11.4375 23.875L11.4219 23.8672L7.03125 20.3594L6.98438 20.3359C6.20313 19.8281 6 19.4766 6 19C6 18.9141 6.01563 18.8125 6.03906 18.7188C6.19531 18.1797 6.73438 17.8906 7.27344 18.0469L12 20V7C12 6.4375 12.4375 6 13 6C13.5625 6 14 6.4375 14 7V14H16V5C16 4.4375 16.4375 4 17 4ZM17.25 16C16.3516 16 16 16.7266 16 17.625C16 19.4531 19 22 19 22C19 22 22 19.5 22 17.625C22 16.7266 21.6484 16 20.75 16C19.5547 16 19 17.3672 19 18C19 17.3672 18.4219 16 17.25 16Z",fill:"#9675F7"})),{Slot:pr,Fill:gr}=(0,h.createSlotFill)("OnboardSiteTypeBefore");function fr(){const{clearVisitedLocations:e}=(0,L.useDispatch)(nr),{siteTypes:t,lastVisitedLocation:r}=(0,L.useSelect)((e=>({siteTypes:e(nr).getSiteTypes(),lastVisitedLocation:e(nr).getLastVisitedLocation()})));return(0,s.createElement)(ir,null,(0,s.createElement)(ar,null),(0,s.createElement)(y.xv,{as:"p",size:y.yH.EXTRA_LARGE,text:(0,l.__)("Welcome to Solid Security! Answer a few questions to quickly enable the most important security features for this website. You can always change settings later.","better-wp-security")}),(0,s.createElement)(pr,null),r&&(0,s.createElement)(y.qX,{onDismiss:e,text:(0,s.createElement)(y.xv,null,(0,s.createInterpolateElement)((0,l.__)("Already started setting up Solid Security? <a>Resume</a> from where you left off.","better-wp-security"),{a:(0,s.createElement)(Z.rU,{to:r})}))}),(0,s.createElement)(sr,null,(0,s.createElement)(y.X6,{level:2,size:y.yH.LARGE,weight:y.fs.HEAVY,text:(0,l.__)("What type of website is this?","better-wp-security")}),(0,s.createElement)(y.xv,{as:"p",variant:y.rK.DARK,text:(0,l.__)("Select the one that best represents your website. This will focus the rest of the setup wizard on the options most necessary to secure the site.","better-wp-security")})),(0,s.createElement)(y.aV,{gap:3},t.map((e=>(0,s.createElement)(y.HC,{key:e.id},(0,s.createElement)(Er,{id:e.id,title:e.title,description:e.description,recommended:e.recommended}))))))}const hr={ecommerce:ur,network:cr,"non-profit":mr,blog:or,brochure:lr,portfolio:dr};function Er({id:e,title:t,description:r,recommended:n}){const{clearSiteType:i}=(0,L.useDispatch)(nr),a=(0,m.$B)(),l=K();return(0,s.createElement)(Ae,{onClick:()=>{i(),l(`${a.url}/${e}`)},title:t,description:r,icon:hr[e],recommended:n})}const yr=(0,u.Z)("div",{target:"ew23jvl2"})({name:"1c6ezy",styles:"display:flex;flex-direction:column;gap:1.5rem;width:100%;max-width:530px;flex-grow:1;justify-content:center;margin-top:-110px"}),vr=(0,u.Z)("header",{target:"ew23jvl1"})({name:"p5tmle",styles:"display:flex;flex-direction:column;gap:0.5rem"}),br=(0,u.Z)("div",{target:"ew23jvl0"})({name:"1bhviol",styles:"display:flex;gap:3.25rem"}),_r=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M9 4C7.35156 4 6 5.35156 6 7V26H6.42188C6.85938 27.1094 7.74219 28 9 28H26V26H9C8.4375 26 8 25.5625 8 25C8 24.4375 8.4375 24 9 24H26V4H9ZM9 6H24V22H9C8.64844 22 8.3125 22.0781 8 22.1875V7C8 6.4375 8.4375 6 9 6ZM10 10V12H22V10H10Z",fill:"#9675F7"})),xr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M22 2C17.5938 2 14 5.59375 14 10C14 10.7109 14.1875 11.3516 14.3594 11.9844L13.875 12.4688L10 8.58594V5.44531L9.53125 5.15625L4.85938 2.23438L2.23438 4.8125L5.4375 10H8.58594L12.4687 13.875L5.17188 21.1719C3.61719 22.7266 3.61719 25.2734 5.17188 26.8281C6.72656 28.3828 9.27344 28.3828 10.8281 26.8281L16 21.6562L21.1719 26.8281C22.7266 28.3828 25.2734 28.3828 26.8281 26.8281C28.3828 25.2734 28.3828 22.7266 26.8281 21.1719L23.5 17.8438C27.1953 17.1406 30 13.8906 30 10C30 8.66406 29.6406 7.42188 29.0781 6.33594L28.4453 5.125L27.4844 6.09375L23.1875 10.3828L21.6172 8.8125L26.875 3.54688L25.6641 2.92188C24.5781 2.35938 23.3359 2 22 2ZM22 4C22.4531 4 22.8438 4.21875 23.2734 4.32813L18.7891 8.8125L23.1875 13.2109L27.6797 8.72656C27.7812 9.15625 28 9.54688 28 10C28 13.3281 25.3281 16 22 16C21.3125 16 20.6562 15.8594 20 15.625L19.4062 15.4219L9.41406 25.4141C8.625 26.2031 7.375 26.2031 6.58594 25.4141C5.79688 24.625 5.79688 23.375 6.58594 22.5859L16.5781 12.5938L16.375 12C16.1406 11.3438 16 10.6875 16 10C16 6.67188 18.6719 4 22 4ZM5.14062 4.76563L8 6.55469V7.83594L7.83594 8H6.5625L4.77344 5.11719L5.14062 4.76563ZM20.0156 17.6406C20.2187 17.6953 20.4219 17.7422 20.625 17.7969L25.4141 22.5859C26.2031 23.375 26.2031 24.625 25.4141 25.4141C24.625 26.2031 23.375 26.2031 22.5859 25.4141L17.4141 20.2422L20.0156 17.6406Z",fill:"#9675F7"})),wr={disableInlineErrors:!0};function Cr({prompt:e,description:t,showErrors:r=!0,goBack:n,children:i}){const{error:a}=(0,L.useSelect)((e=>({error:e(nr).getLastError()})),[]);return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(yr,null,(0,s.createElement)(vr,null,(0,s.createElement)(y.X6,{level:3,text:e,size:y.yH.EXTRA_LARGE,variant:y.rK.DARK}),(0,s.createElement)(y.xv,{as:"p",text:t,variant:y.rK.MUTED})),r&&(0,s.createElement)(j.KM,{apiError:a}),i),n&&(0,s.createElement)(Xe,null,(0,s.createElement)(y.zx,{onClick:n,text:(0,l.__)("Back","better-wp-security"),icon:Ue.Z,iconPosition:"left",variant:"tertiary"})))}function Sr({question:e,onAnswer:t,isAnswering:r,goBack:n}){const{editAnswer:i}=(0,L.useDispatch)(nr),{answer:a,error:o}=(0,L.useSelect)((e=>({error:e(nr).getLastError(),answer:e(nr).getEditedAnswer()}))),[c,d]=(0,s.useState)([]);return(0,s.createElement)(Cr,{prompt:e.prompt,description:e.description,showErrors:!1,goBack:n},(0,s.createElement)(j.T,{schema:e.answer_schema,uiSchema:e.answer_schema.uiSchema,formData:a,onChange:({formData:e})=>i(e),onSubmit:({formData:e},r)=>{r.preventDefault(),d([]),t(e)},saveLabel:(0,l.__)("Next","better-wp-security"),formContext:wr,apiError:o,schemaError:c,onError:d,showErrorList:!1,saveDisabled:r,undoDisabled:r,alignActions:"start"}))}function Lr({question:e,onAnswer:t,isAnswering:r}){return(0,s.createElement)(Cr,{prompt:e.prompt,description:e.description},(0,s.createElement)(br,null,(0,s.createElement)(Ae,{disabled:r,onClick:()=>t(!1),title:(0,l.__)("My Own Website","better-wp-security"),direction:"vertical",icon:_r}),(0,s.createElement)(Ae,{disabled:r,onClick:()=>t(!0),title:(0,l.__)("Client Website","better-wp-security"),direction:"vertical",icon:xr})))}function Or(){const{registerQuestionComponent:e}=(0,L.useDispatch)(nr);(0,V.eH)(Or,(()=>{e("is-client",Lr)}))}function Nr(){Or();const{goNext:e}=D(),{siteType:t}=(0,m.UO)(),{selectedSiteTypeId:r}=(0,L.useSelect)((e=>({selectedSiteTypeId:e(nr).getSelectedSiteTypeId()})),[]),{selectSiteType:n,applyAnswerResponse:i}=(0,L.useDispatch)(nr),a=function(){const{question:e,component:t,isAnswering:r}=(0,L.useSelect)((e=>{const t=e(nr).getNextQuestion();return{question:t,component:e(nr).getQuestionComponent(t?.id),isAnswering:e(nr).isAnswering()}}),[]),{answerQuestion:n,repeatQuestion:i}=(0,L.useDispatch)(nr);if(!e)return e;const a=(0,s.memo)(t||Sr);return(0,s.createElement)(a,{question:e,onAnswer:n,goBack:i,isAnswering:r})}();return(0,s.useLayoutEffect)((()=>{r!==t&&n(t)}),[n,r,t]),(0,s.useEffect)((()=>{null===a&&(i(),e())}),[i,e,a]),a}function Ir(){const{path:e}=(0,m.$B)();return(0,s.createElement)(m.rs,null,(0,s.createElement)(m.AW,{path:`${e}/:siteType`},(0,s.createElement)(Nr,null)),(0,s.createElement)(m.AW,{path:`${e}`},(0,s.createElement)(fr,null)))}var Tr=r(36058),kr=r(96015),Mr=r(83904);const Ar=(0,u.Z)(y.mr,{target:"e8ef6wn17"})({name:"8dk3vg",styles:"margin-bottom:1rem"}),Rr=(0,u.Z)(y.Tg,{target:"e8ef6wn16"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";"),Dr=(0,u.Z)(j.KM,{target:"e8ef6wn15"})({name:"1102gqn",styles:"margin:0 1.5rem 1rem"}),Zr=(0,u.Z)("form",{target:"e8ef6wn14"})({name:"1smerdt",styles:"padding:1rem 0"}),Fr=(0,u.Z)(j.b,{target:"e8ef6wn13"})({name:"1traxmt",styles:"& .itsec-rjsf-object-fieldset>.form-group,& .itsec-rjsf-object-fieldset>.itsec-rjsf-section-title{padding:0 1.5rem;}"}),Pr=(0,u.Z)("div",{target:"e8ef6wn12"})({name:"e59tbw",styles:"display:flex;align-items:center;justify-content:end;gap:1.5rem;margin-top:2rem"}),Hr=(0,u.Z)("form",{target:"e8ef6wn11"})({name:"jg4g8",styles:"padding:1.25rem 1.5rem;display:flex;flex-direction:column;gap:1.25rem"}),Vr=(0,u.Z)("section",{target:"e8ef6wn10"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";box-shadow:",(({theme:e,isHighlighted:t})=>t&&`0 0 0 var(--wp-admin-border-width-focus) ${e.colors.primary.base}`),";"),Br=(0,u.Z)("header",{target:"e8ef6wn9"})("padding:1.25rem 1rem;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";display:flex;align-items:center;justify-content:space-between;"),jr=(0,u.Z)("div",{target:"e8ef6wn8"})({name:"1dvcxr3",styles:"padding:1rem"}),zr=(0,u.Z)("button",{target:"e8ef6wn7"})({name:"1jnezc0",styles:'display:grid;grid-template-areas:"title graphic" "description graphic";grid-template-columns:auto min-content;align-items:center;gap:0.5rem;width:100%;padding:1rem;cursor:pointer;background-color:transparent;border-width:0;&[disabled]{cursor:default;}'}),$r=(0,u.Z)(y.xv,{target:"e8ef6wn6"})({name:"1ce9wo2",styles:"grid-area:title"}),qr=(0,u.Z)(y.xv,{target:"e8ef6wn5"})({name:"1x9glg",styles:"grid-area:description"}),Ur=(0,u.Z)(h.Icon,{target:"e8ef6wn4"})({name:"rkr399",styles:"grid-area:graphic"}),Wr=(0,u.Z)("div",{target:"e8ef6wn3"})("display:",(({isOpen:e})=>e?"block":"none"),";padding:1rem 0;background:#f6f7f7;"),Gr=(0,u.Z)("div",{target:"e8ef6wn2"})({name:"l7eclt",styles:"padding:0 1rem 1rem"}),Kr=(0,u.Z)(j._g,{target:"e8ef6wn1"})({name:"17zhf76",styles:"padding:0 1.5rem"}),Yr=(0,u.Z)("div",{target:"e8ef6wn0"})({name:"7tt4sl",styles:"flex-grow:1;max-width:830px;width:100%"});function Qr(){const{root:e}=(0,m.UO)(),{editedModules:t}=(0,L.useSelect)((e=>({editedModules:e(O.MODULES_STORE_NAME).getEditedModules()})),[]),r=t.filter((t=>{if("onboard"===e&&!t.onboard)return!1;if("import"===e&&!t.settings?.import?.length>0)return!1;const r=t.settings?.show_ui;return r||"always-active"!==t.status.default})),n=(0,v.sortBy)(r,"order");return{types:[{slug:"login",label:(0,l.__)("Login Security","better-wp-security")},{slug:"lockout",label:(0,l.__)("Firewall","better-wp-security")},{slug:"site-check",label:(0,l.__)("Site Check","better-wp-security")},{slug:"utility",label:(0,l.__)("Utilities","better-wp-security")},{slug:"advanced",label:(0,l.__)("Advanced","better-wp-security")}].filter((e=>r.find((t=>t.type===e.slug)))),modules:n}}const{Slot:Xr,Fill:Jr}=(0,h.createSlotFill)("ConfigurePageHeader");function en({module:e}){const t=(0,S.useInstanceId)(en,"itsec-configure-single-modules-page"),{config:r}=(0,L.useSelect)((t=>({config:t(O.MODULES_STORE_NAME).getEditedModule(e)})),[e]),{saveSettings:n}=(0,L.useDispatch)(O.MODULES_STORE_NAME),{filterFields:i}=Q(r),{schema:a,uiSchema:l,formData:o,setFormData:c}=Y(r,i);return r?(0,s.createElement)(cn,{title:r.title,description:r.description,headerHasBorder:!0},(0,s.createElement)(Rr,null,(0,s.createElement)(Xr,null),(0,s.createElement)(Zr,{onSubmit:e=>{e.preventDefault(),n(r.id,!0)},id:t},(0,s.createElement)(ln,{module:r,schema:a,uiSchema:l,formData:o,setFormData:c}))),(0,s.createElement)(on,{form:t,modules:[e]})):null}function tn({type:e,title:t,description:r}){const n=(0,S.useInstanceId)(tn,"itsec-configure-modules-of-type-page"),{modules:i}=Qr(),a=(0,s.useMemo)((()=>i.filter((t=>t.type===e))),[i,e]),l=(0,s.useMemo)((()=>a.map((e=>e.id))),[a]),{saveSettings:o}=(0,L.useDispatch)(O.MODULES_STORE_NAME);return a?(0,s.createElement)(cn,{title:t,description:r,headerHasBorder:!0},(0,s.createElement)(Rr,null,(0,s.createElement)(Xr,null),(0,s.createElement)(Hr,{id:n,onSubmit:e=>{e.preventDefault(),o(l,!0)}},a.map((e=>(0,s.createElement)(an,{key:e.id,module:e}))))),(0,s.createElement)(on,{form:n,modules:l})):null}function rn({exclude:e}){const{types:t,modules:r}=Qr(),n=(0,s.useMemo)((()=>t.filter((t=>!e.includes(t.slug)))),[t,e]),{path:i,url:a}=(0,m.$B)();return(0,s.createElement)(m.rs,null,(0,s.createElement)(m.AW,{path:`${i}/:type`},(0,s.createElement)(nn,{allModules:r},(0,s.createElement)(Xr,null),(0,s.createElement)(Kr,{size:y.yH.NORMAL},n.map((e=>(0,s.createElement)(j.uC,{key:e.slug,title:e.label,to:`${a}/${e.slug}`})))))),(0,s.createElement)(m.AW,{path:i,exact:!0},n.length>0&&(0,s.createElement)(m.l_,{to:`${a}/${n[0].slug}`})))}function nn({allModules:e,children:t}){const r=(0,S.useInstanceId)(rn,"itsec-configure-tabbed-modules-route"),{params:n}=(0,m.$B)(),i=(0,s.useMemo)((()=>e.filter((e=>e.type===n.type))),[e,n]),a=(0,s.useMemo)((()=>i.map((e=>e.id))),[i]),{saveSettings:o}=(0,L.useDispatch)(O.MODULES_STORE_NAME);return(0,s.createElement)(cn,{title:(0,l.__)("Features","better-wp-security"),description:(0,l.__)("Choose and configure security features for your site.","better-wp-security")},(0,s.createElement)(Rr,null,t,(0,s.createElement)(Hr,{id:r,onSubmit:e=>{e.preventDefault(),o(a,!0)}},i.map((e=>(0,s.createElement)(an,{key:e.id,module:e}))))),(0,s.createElement)(on,{form:r,modules:a}))}function an({module:e}){const{root:t}=(0,m.UO)(),{hash:r}=(0,m.TH)(),[n,i]=(0,s.useState)(!1),a="active"===e.status.selected,o=function(){const{featureFlags:e,siteInfo:t,requirementsInfo:r}=(0,L.useSelect)((e=>({featureFlags:e(O.CORE_STORE_NAME).getFeatureFlags(),siteInfo:e(O.CORE_STORE_NAME).getSiteInfo(),requirementsInfo:e(O.CORE_STORE_NAME).getRequirementsInfo()})),[]);return(0,s.useCallback)(((n,i)=>{const a=new U.PN;if(!n.requirements)return a;const s=e=>e.validate===i||"activate"===i;if(n.requirements.ssl&&s(n.requirements.ssl)&&"https:"!==document.location.protocol&&a.add("ssl",(0,l.__)("Your site must support SSL.","better-wp-security"),n.requirements.ssl),n.requirements["feature-flags"]&&s(n.requirements["feature-flags"]))for(const t of n.requirements["feature-flags"].flags)e.includes(t)||a.add("feature-flags",(0,l.sprintf)((0,l.__)("The '%s' feature flag must be enabled.","better-wp-security"),t),n.requirements["feature-flags"]);if(n.requirements.multisite&&s(n.requirements.multisite)&&("enabled"===n.requirements.multisite.status&&!1===t?.multisite?a.add("multisite",(0,l.__)("Multisite must be enabled.","better-wp-security"),n.requirements.multisite):"disabled"===n.requirements.multisite.status&&!0===t?.multisite&&a.add("multisite",(0,l.__)("Multisite is not supported.","better-wp-security"),n.requirements.multisite)),n.requirements.server&&s(n.requirements.server)&&r){!n.requirements.server.php||(o=r.server.php,c=n.requirements.server.php,o.localeCompare(c,void 0,{numeric:!0,sensitivity:"base"})>=0)||a.add("server",(0,l.sprintf)((0,l.__)("You must be running PHP version %s or later.","better-wp-security"),n.requirements.server.php),n.requirements.server);const e=(n.requirements.server.extensions||[]).filter((e=>!r.server.extensions[e]));1===e.length?a.add("server",(0,l.sprintf)((0,l.__)("The %s PHP extension is required.","better-wp-security"),e[0]),n.requirements.server):e.length>0&&a.add("server",(0,l.sprintf)((0,l._n)("The following PHP extension is required: %l.","The following PHP extensions are required: %l.",e.length,"better-wp-security").replace("%l","%s"),e.join(", ")),n.requirements.server)}var o,c;return n.requirements.load&&s(n.requirements.load)&&r&&("normal"===n.requirements.load.type&&"early"===r.load?a.add("load",(0,l.__)("Loading Solid Security via an MU-Plugin is not supported.","better-wp-security")):"early"===n.requirements.load.type&&"normal"===r.load&&a.add("load",(0,l.__)("Loading Solid Security without an MU-Plugin is not supported.","better-wp-security"))),a}),[e,t,r])}(),c=o(e,a?"run":"activate"),{allowedFields:d,filterFields:u}=Q(e),{schema:p,uiSchema:g,hasSettings:f,formData:h,setFormData:E}=Y(e,u);if(!a&&c.hasErrors()&&!c.getErrorCodes().some((e=>c.getErrorData(e)[0].showMessageIfUnmet)))return null;if("always-active"===e.status.default&&!f)return null;const v="always-active"!==e.status.default&&!c.hasErrors(),b=!(!e.settings?.show_ui||c.hasErrors()||Array.isArray(d)&&!d.length),_=r===`#${e.id}`||r.startsWith(`#${e.id},`),x=n||_;return(0,s.createElement)(Vr,{isHighlighted:_},(0,s.createElement)(Br,null,v&&(0,s.createElement)(sn,{module:e,setSettingsOpen:i,persist:"settings"===t}),!v&&(0,s.createElement)(y.xv,{text:e.title}),(0,s.createElement)(y.zx,{icon:Tr.Z,label:(0,l.__)("View external documentation.","better-wp-security"),href:"https://go.solidwp.com/security-basic-help-docs",target:"_blank",variant:"tertiary",isSmall:!0})),!b&&(0,s.createElement)(jr,null,(0,s.createElement)(y.xv,{size:y.yH.SMALL},(0,s.createElement)(j.Lu,{noWrap:!0,content:e.description}))),b&&(0,s.createElement)(zr,{onClick:()=>i(!n),"aria-expanded":x,"aria-controls":`itsec-module-settings-${e.id}`,disabled:!a,type:"button"},(0,s.createElement)($r,{text:(0,l.sprintf)((0,l.__)("%s Settings","better-wp-security"),e.title)}),(0,s.createElement)(qr,{text:e.description,size:y.yH.SMALL}),a&&b&&(0,s.createElement)(Ur,{icon:x?kr.Z:Mr.Z})),a&&b&&(0,s.createElement)(Wr,{isOpen:x,variant:y.h1.PRIMARY_CONTRAST,id:`itsec-module-settings-${e.id}`},(0,s.createElement)(ln,{module:e,schema:p,uiSchema:g,formData:h,setFormData:E})),c.hasErrors()&&(0,s.createElement)(Gr,null,(0,s.createElement)(j.KM,{errors:c.getAllErrorMessages()})))}function sn({module:e,setSettingsOpen:t,persist:r}){const n="active"===e.status.selected,[i,a]=(0,s.useState)(!1),{activateModule:o,deactivateModule:c,editModule:d}=(0,L.useDispatch)(O.MODULES_STORE_NAME);return(0,s.createElement)(h.ToggleControl,{label:e.title,checked:n,onChange:async n=>{a(!0),n?(await(r?o(e.id):d(e.id,{status:{selected:"active"}})),t(!0)):await(r?c(e.id):d(e.id,{status:{selected:"inactive"}})),a(!1)},disabled:i,"aria-label":(0,l.sprintf)((0,l.__)("Enable the “%s” module.","better-wp-security"),e.title),"aria-describedby":`itsec-module-description--${e.id}`,__nextHasNoMarginBottom:!0})}function ln({module:e,schema:t,uiSchema:r,formData:n,setFormData:i}){const a=(0,S.useInstanceId)(ln,`itsec-configure-${e.id}`),{hash:l}=(0,m.TH)(),{apiError:o}=(0,L.useSelect)((t=>({apiError:t(O.MODULES_STORE_NAME).getError(e.id)})),[e.id]),c=l.startsWith(`#${e.id},`)?l.split(",")[1]:l.replace("#",""),d=(0,s.useMemo)((()=>{return c?(e=r?(0,v.cloneDeep)(r):{},t=[c,"classNames"],"itsec-highlighted-search-result",(0,v.set)(e,t,H()((0,v.get)(e,t),"itsec-highlighted-search-result")),e):r;var e,t}),[r,c]),u=(0,s.useMemo)((()=>({module:e.id,disableInlineErrors:!0})),[e.id]);return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(Dr,{apiError:o}),(0,s.createElement)(Fr,{tagName:"div",id:a,schema:t,uiSchema:d,formData:n,onChange:i,idPrefix:`itsec_${e.id}`,formContext:u,showErrorList:!1}))}function on({modules:e,form:t}){const{isSaving:r,isDirty:n}=(0,L.useSelect)((t=>({isDirty:t(O.MODULES_STORE_NAME).getDirtySettings().some((t=>e.includes(t))),isSaving:t(O.MODULES_STORE_NAME).isSavingSettings(e)})),[e]),{resetSettingEdits:i}=(0,L.useDispatch)(O.MODULES_STORE_NAME),{root:a}=(0,m.UO)(),{goNext:o}=D();return(0,s.createElement)(Pr,null,(0,s.createElement)(y.zx,{text:(0,l.__)("Undo Changes","better-wp-security"),variant:"secondary",onClick:()=>i(e),disabled:r||!n}),"settings"===a&&(0,s.createElement)(y.zx,{type:"submit",form:t,text:(0,l.__)("Save","better-wp-security"),variant:"primary",isBusy:r,disabled:r||!n}),"settings"!==a&&(0,s.createElement)(y.zx,{text:(0,l.__)("Next","better-wp-security"),variant:"primary",onClick:o}))}function cn({title:e,description:t,headerHasBorder:r,children:n}){const{root:i}=(0,m.UO)();return"settings"===i?(0,s.createElement)(React.Fragment,null,(0,s.createElement)(Jr,null,(0,s.createElement)(Ar,{title:e,description:t,hasBorder:r})),n):(0,s.createElement)(Yr,null,(0,s.createElement)(qe,{title:e,description:t,showIndicator:!0,showNext:!0}),n)}const dn=(0,u.Z)(h.Spinner,{target:"e1lluxma0"})({name:"1goa6k7",styles:"width:80px!important;height:80px!important"});function un(){const{root:e}=(0,m.UO)(),{goNext:t}=D(),{completeOnboarding:r}=(0,L.useDispatch)(nr);return mn(),(0,V.eH)(un,(()=>{r({root:e}).then(t)})),(0,s.createElement)(h.Flex,{expanded:!1,direction:"column",gap:4,align:"center"},(0,s.createElement)(dn,null),(0,s.createElement)(y.xv,{size:y.yH.LARGE,variant:y.rK.DARK,weight:y.fs.HEAVY,align:"center",text:(0,l.__)("Hang on while your website is secured!","better-wp-security")}))}function mn(){const{registerCompletionStep:e}=(0,L.useDispatch)(nr),{saveModules:t,saveSettings:r}=(0,L.useDispatch)(O.MODULES_STORE_NAME);(0,V.eH)(mn,(()=>{e({id:"savingModules",label:(0,l.__)("Enable Features","better-wp-security"),priority:5,callback:()=>t()}),e({id:"savingSettings",label:(0,l.__)("Configure Settings","better-wp-security"),priority:10,callback:()=>r()})}))}const pn=(0,u.Z)("div",{target:"e62zy9t6"})("max-width:900px;width:100%;flex-grow:1;margin-top:",(({isSmall:e})=>e&&"100px"),";"),gn=(0,u.Z)("ul",{target:"e62zy9t5"})({name:"a5ny1u",styles:"list-style:disc inside;display:flex;flex-direction:column;gap:0.75rem;margin:0"}),fn=(0,u.Z)("li",{target:"e62zy9t4"})({name:"11utca0",styles:"margin:0 0.5rem"}),hn=(0,u.Z)("div",{target:"e62zy9t3"})("margin-top:3.5rem;padding:1.5rem;border:1px solid ",(({theme:e})=>e.colors.border.normal),';border-radius:2px;box-shadow:0 4px 8px 0 #00000033;background:no-repeat url("',q.sC,'");background-position:right -40px top -35px;background-size:180px;@media screen and (min-width: ',(({theme:e})=>e.breaks.small),"px ){background-position:right -50% center;background-size:65%;}"),En=(0,u.Z)(h.Flex,{target:"e62zy9t2"})({name:"15xgxri",styles:"max-width:700px"}),yn=(0,u.Z)(y.aV,{target:"e62zy9t1"})({name:"1f342kp",styles:"display:grid;grid-template-columns:repeat(auto-fit, minmax(225px, 1fr));gap:1.25rem"}),vn=(0,u.Z)(y.zx,{target:"e62zy9t0"})({name:"135vrw8",styles:"align-self:start"}),bn=[{text:(0,l.__)("User security strengthened","better-wp-security"),activeModules:["two-factor","passwordless-login","fingerprinting"]},{text:(0,l.__)("Brute force attacks blocked","better-wp-security"),activeModules:["brute-force","network-brute-force","recaptcha"]},{text:(0,l.__)("Scanning for vulnerable themes, plugins, and known malware","better-wp-security"),activeModules:["malware-scheduling"]},{text:(0,l.__)("Monitoring for suspicious file changes","better-wp-security"),activeModules:["file-change"]},{text:(0,l.__)("Banning bad bots and user agents","better-wp-security"),activeModules:["ban-users"]}];function _n(){const{allActiveModules:e}=(0,L.useSelect)((e=>({allActiveModules:e(O.MODULES_STORE_NAME).getActiveModules()})),[]),t=bn.filter((({activeModules:t})=>t.find((t=>e.includes(t)))));return t.length?(0,s.createElement)(h.Flex,{direction:"column",gap:3,justify:"start",expanded:!1},(0,s.createElement)(y.X6,{level:3,size:y.yH.LARGE,variant:y.rK.DARK,weight:y.fs.HEAVY,text:(0,l.__)("Here are some notable improvements…","better-wp-security")}),(0,s.createElement)(gn,null,t.map((({text:e},t)=>(0,s.createElement)(fn,{key:t},(0,s.createElement)(y.xv,{text:e})))))):null}function xn({installType:e}){const t=(0,U.bv)("dashboard"),r=(0,U.bv)("settings");return(0,s.createElement)(h.Flex,{direction:"column",gap:8,expanded:!1,align:"start"},(0,s.createElement)(j.TR,{size:44}),(0,s.createElement)(h.Flex,{as:"header",direction:"column",gap:2,expanded:!1},(0,s.createElement)(y.X6,{level:1,text:"free"===e?(0,l.__)("Great Work! Thanks to Solid Security Basic, your site is secure and ready for your users.","better-wp-security"):(0,l.__)("Great Work! Your site is ready and is more secure than ever!","better-wp-security"),size:y.yH.GIGANTIC,weight:y.fs.NORMAL}),(0,s.createElement)(y.xv,{text:"free"===e?(0,l.__)("Use your security dashboard for insights into your users’ activity and potential threats to your site. From there you’ll be guided to actions you can take.","better-wp-security"):(0,l.__)("If you want to dig into your site’s security, check out your security dashboard, and make changes via settings.","better-wp-security"),size:y.yH.EXTRA_LARGE,variant:y.rK.DARK})),(0,s.createElement)(h.Flex,{gap:4,justify:"start"},(0,s.createElement)(y.zx,{variant:"free"===e?"secondary":"primary",href:t,text:(0,l.__)("Dashboard","better-wp-security")}),(0,s.createElement)(y.zx,{variant:"free"===e?"secondary":"primary",href:r,text:(0,l.__)("Settings","better-wp-security")})),(0,s.createElement)(_n,{installType:e}))}var wn=r(14776);const Cn=(0,s.createElement)(wn.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)(wn.Path,{d:"M9 13.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM9 16a4.002 4.002 0 003.8-2.75H15V16h2.5v-2.75H19v-2.5h-6.2A4.002 4.002 0 005 12a4 4 0 004 4z",fillRule:"evenodd",clipRule:"evenodd"})),Sn=[(0,s.createInterpolateElement)((0,l.__)("A <b>Firewall</b> that automatically blocks brute force logins, password-stuffing, DDoS attacks, bad bots, and any attempts to exploit vulnerable software on your site.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("<b>Virtual Patches</b> from <b>Patchstack</b> that protect insecure themes and plugins even before vulnerabilities are publicly disclosed and an official patch is released. You may not be able to apply security updates immediately, but with Solid Security Pro you’re still protected until you’re ready to update.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("<b>Version Management</b> gives you precise control over when to apply or delay an automatic update to any plugin, theme, extension, or WordPress core.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("<b>Passkeys</b> and other <b>Passwordless</b> Login options mitigate the risks associated with users who often share, reuse, and choose weak passwords. Increase your users’ security and simplify their login experience.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("Multiple <b>CAPTCHA</b> options, including <b>Cloudflare Turnstile</b>, eliminate bot traffic from your login screens and other forms. You won’t be asked to solve a puzzle or identify objects to prove you’re a human — unless you’re a bot.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})})],Ln=[(0,l.__)("Passwordless Login and Passkeys","better-wp-security"),(0,l.__)("Two-Factor","better-wp-security"),(0,l.__)("Captcha","better-wp-security"),(0,l.__)("Version Management","better-wp-security"),(0,l.__)("Trusted Devices","better-wp-security"),(0,l.__)("Import & Export","better-wp-security"),(0,l.__)("WP-CLI","better-wp-security")];function On({installType:e}){return(0,s.createElement)(hn,null,(0,s.createElement)(En,{direction:"column",justify:"start",expanded:!1,gap:4},(0,s.createElement)(y.X6,{level:2,weight:y.fs.NORMAL,size:y.yH.EXTRA_LARGE,variant:y.rK.ACCENT,text:"free"===e?(0,l.__)("Reduce your site’s security risk to nearly zero with Solid Security Pro.","better-wp-security"):(0,l.__)("Greatly enhance your website’s security with Solid Security Pro.","better-wp-security")}),(0,s.createElement)(y.xv,{variant:y.rK.MUTED,text:"free"===e?(0,l.__)("Extended features for professionals include:","better-wp-security"):(0,l.__)("You are a WordPress security superstar! Be sure to take advantage of the features that comes with your paid plan. Paid features include…","better-wp-security")}),(0,s.createElement)(yn,{textVariant:y.rK.DARK,gap:0},"free"===e?(0,s.createElement)(React.Fragment,null,Sn.map(((e,t)=>(0,s.createElement)(y.HC,{icon:Cn,text:e,key:t})))):(0,s.createElement)(React.Fragment,null,Ln.map(((e,t)=>(0,s.createElement)(y.HC,{icon:Cn,text:e,key:t}))))),"free"===e?(0,s.createElement)(vn,{href:"https://go.solidwp.com/go-pro-onboarding",variant:"primary",text:(0,l.__)("Upgrade to Solid Security Pro","better-wp-security")}):(0,s.createElement)(y.xv,{variant:y.rK.MUTED,text:(0,l.__)("and more!","better-wp-security")})))}function Nn(){const{installType:e}=(0,L.useSelect)((e=>({installType:e(O.coreStore).getInstallType()})),[]),t=(0,S.useViewportMatch)("small");return(0,s.createElement)(pn,{isSmall:t},(0,s.createElement)(xn,{installType:e}),(0,s.createElement)(On,{installType:e}))}function In(){const e=M(),{url:t,path:r}=(0,m.$B)(),{pathname:n}=(0,m.TH)(),{recordVisitedLocation:i}=(0,L.useDispatch)(nr);return(0,s.useEffect)((()=>{i(n)}),[i,n]),(0,s.createElement)(m.rs,null,e.map((({id:e,render:n})=>(0,s.createElement)(m.AW,{path:`${r}/:page(${e})`,key:e},(0,s.createElement)(et,{url:t,render:n})))),(0,s.createElement)(m.AW,{path:t},e.length>0&&(0,s.createElement)(m.l_,{to:`${t}/${e[0].id}`}),(0,s.createElement)(tt,null)))}var Tn=r(50460);function kn(){const e=M(),{url:t,path:r}=(0,m.$B)();return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(j.ge,{area:"main"},(0,s.createElement)(Tn.o,null)),(0,s.createElement)(m.rs,null,e.map((({id:e,render:t})=>(0,s.createElement)(m.AW,{path:`${r}/:page(${e})`,key:e},(0,s.createElement)(ve,null,(0,s.createElement)(Ve,null),(0,s.createElement)(t,null))))),(0,s.createElement)(m.AW,{path:t},e.length>0&&(0,s.createElement)(m.l_,{to:`${t}/${e[0].id}`}),(0,s.createElement)(ve,null))))}function Mn(){const e=M(),{url:t,path:r}=(0,m.$B)();return e.length>0&&!e.find((e=>"select-export"===e.id))?(0,s.createElement)(m.l_,{to:"/"}):(0,s.createElement)(m.rs,null,e.map((({id:e,render:n})=>(0,s.createElement)(m.AW,{path:`${r}/:page(${e})`,key:e},(0,s.createElement)(et,{url:t,render:n})))),(0,s.createElement)(m.AW,{path:t},e.length>0&&(0,s.createElement)(m.l_,{to:`${t}/${e[0].id}`}),(0,s.createElement)(tt,null)))}function An(){return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(T,{id:"site-type",title:(0,l.__)("Website","better-wp-security"),priority:0,roots:["onboard"]},(()=>(0,s.createElement)(Ir,null))),(0,s.createElement)(T,{id:"global",title:(0,l.__)("Global Settings","better-wp-security"),priority:4,roots:["onboard","settings","import"]},(()=>(0,s.createElement)(en,{module:"global"}))),(0,s.createElement)(T,{id:"configure",title:(0,l.__)("Features","better-wp-security"),priority:6,roots:["onboard","settings","import"]},(()=>(0,s.createElement)(rn,{exclude:["advanced"]}))),(0,s.createElement)(T,{id:"advanced",title:(0,l.__)("Advanced","better-wp-security"),priority:25,roots:["settings"]},(()=>(0,s.createElement)(tn,{type:"advanced",title:(0,l.__)("Advanced","better-wp-security"),description:(0,l.__)("Configure advanced Solid Security settings.","better-wp-security")}))),(0,s.createElement)(T,{id:"secure-site",title:(0,l.__)("Secure Site","better-wp-security"),priority:95,roots:["onboard","import"],hideFromNav:!0},(()=>(0,s.createElement)(un,null))),(0,s.createElement)(T,{id:"summary",title:(0,l.__)("Summary","better-wp-security"),priority:100,roots:["onboard","import"],hideFromNav:!0},(()=>(0,s.createElement)(Nn,null))))}function Rn(){const{registerProvider:e}=(0,L.useDispatch)(Tn.G);(0,V.eH)(Rn,(()=>{e("modules",(0,l.__)("Features","better-wp-security"),5,(({registry:e,evaluate:t,results:r})=>e.select(O.MODULES_STORE_NAME).getEditedModules().reduce(((e,n)=>{const i=Dn(n);return i&&(t.stringMatch(n.title)||t.stringMatch(n.description)||t.keywordMatch(n.keywords))?(r.items.push({title:n.title,description:n.description,route:i}),e+1):e}),0))),e("settings",(0,l.__)("Settings","better-wp-security"),20,(({registry:e,evaluate:t,results:r})=>e.select(O.MODULES_STORE_NAME).getEditedModules().reduce(((e,n)=>{if("active"!==n.status.selected||!n.settings?.interactive?.length)return e;const i=Dn(n);return i?e+n.settings.interactive.reduce(((e,a)=>{var s,l,o;const c=n.settings.schema.properties[a],d=n.settings.schema.uiSchema?.[a];if(!c)return e;const u=d?.ui?.title||d?.["ui:title"]||c.title,m=d?.ui?.description||d?.["ui:description"]||c.description;if(!t.stringMatch(u)&&!t.stringMatch(m)&&!t.keywordMatch(c.keywords))return e;null!==(o=(s=r.groups)[l=n.id])&&void 0!==o||(s[l]={title:n.title,items:[]});const p=i.includes("#")?`${i},${a}`:`${i}#${a}`;return r.groups[n.id].items.push({title:u,description:m,route:p}),e++}),0):e}),0)))}))}function Dn(e){if("global"===e.id)return"/settings/global";if("custom"!==e.type&&"tool"!==e.type&&"recommended"!==e.type){if("advanced"===e.type)return`/settings/advanced#${e.id}`;if("always-active"!==e.status.default||e.settings?.show_ui)return`/settings/configure/${e.type}#${e.id}`}}const Zn=(0,u.Z)(y.Tg,{target:"e1qzbj170"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"});function Fn({history:e,serverType:t,installType:r,onboardComplete:n}){Rn();const i=n?"/settings":"/onboard";return(0,s.createElement)(f.a,{theme:y.U1},(0,s.createElement)(Zn,{className:"itsec-settings",variant:y.h1.UNDER_PAGE},(0,s.createElement)(W.Provider,{value:{serverType:t,installType:r,onboardComplete:n}},(0,s.createElement)(m.F0,{history:e},(0,s.createElement)(p.Fz,{ReactRouterRoute:m.AW},(0,s.createElement)(h.SlotFillProvider,null,(0,s.createElement)(g.ErrorBoundary,{FallbackComponent:Pn},(0,s.createElement)(I,null,(0,s.createElement)(An,null),(0,s.createElement)(E.PluginArea,null),(0,s.createElement)(h.Popover.Slot,null),(0,s.createElement)(m.rs,null,(0,s.createElement)(m.AW,{path:"/:root(settings)",component:kn}),(0,s.createElement)(m.AW,{path:"/:root(onboard)",component:In}),(0,s.createElement)(m.AW,{path:"/:root(import)",component:Mn}),(0,s.createElement)(m.AW,{path:"/"},(0,s.createElement)(m.l_,{to:i}),(0,s.createElement)(B,null),(0,s.createElement)(ve,null)))))))))))}function Pn(e){return(0,s.createElement)(h.Flex,null,(0,s.createElement)(h.FlexBlock,null,(0,s.createElement)(Ze,e)))}r.p=window.itsecWebpackPublicPath,(0,l.setLocaleData)({"":{}},"better-wp-security");const Hn=(0,d.f)(document.location,{page:"itsec"});c()((()=>{const e=document.getElementById("itsec-settings-root"),t=e.dataset.serverType,r=e.dataset.installType,n="1"===e.dataset.onboard;return(0,s.render)((0,s.createElement)(Fn,{history:Hn,serverType:t,installType:r,onboardComplete:n}),e)}))},79612:(e,t,r)=>{"use strict";r.d(t,{f:()=>s});var n=r(90071),i=r(17563),a=r(92819);function s(e,t){const r=(0,n.lX)(),s=r=>{const a="string"==typeof r?(0,n.cP)(r):r,s=(0,i.parse)(a.search?.substring(1))||{};return{...a,pathname:e.pathname,search:"?"+(0,i.stringify)({...s,path:a.pathname,...t})}};return{get length(){return r.length},get action(){return r.action},get location(){const e=(0,i.parse)(r.location.search.substring(1)),n=e.path||"/";return{...r.location,pathname:n,search:"?"+(0,i.stringify)((0,a.omit)(e,["path",Object.keys(t)]))}},createHref:e=>r.createHref(s(e)),push:(e,t)=>{r.push(s(e),t)},replace:(e,t)=>{r.replace(s(e),t)},go:(...e)=>r.go.apply(r,e),goBack:(...e)=>r.goBack.apply(r,e),goForward:(...e)=>r.goForward.apply(r,e),block:(...e)=>r.block.apply(r,e),listen(e){return r.listen((()=>{e(this.location,this.action)}))}}}},33590:(e,t,r)=>{"use strict";r.d(t,{bB:()=>$,ZP:()=>X});var n={};r.r(n),r.d(n,{BaseInput:()=>d,CheckboxWidget:()=>p,CheckboxesWidget:()=>g,IncludeExcludeWidget:()=>k,RadioWidget:()=>O,SelectWidget:()=>b,TextareaWidget:()=>x,ToggleWidget:()=>m});var i={};r.r(i),r.d(i,{EntitySelectField:()=>F,FileTreeField:()=>z,TextareaListField:()=>H,TitleField:()=>R});var a=r(92819),s=r(87462),l=r(6293),o=r(64893),c=r(36179);const d=function(e){const{id:t,label:r,value:n,readonly:i,disabled:d,onBlur:u,onFocus:m,options:p,onChange:g,schema:f,uiSchema:h={},...E}=e;p.inputType?E.type=p.inputType:E.type||("number"===f.type?(E.type="number",E.step="any"):"integer"===f.type?(E.type="number",E.step="1"):E.type="text"),p.autocomplete&&(E.autoComplete=p.autocomplete),f.multipleOf&&(E.step=f.multipleOf),void 0!==f.minimum&&(E.min=f.minimum),void 0!==f.maximum&&(E.max=f.maximum);const y=h["ui:description"]||f.description;return(0,l.createElement)(o.TextControl,(0,s.Z)({label:r,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:y}),readOnly:i,disabled:d,value:n||""},(0,a.omit)(E,["autofocus","formContext","registry","rawErrors"]),{onChange:e=>g(""===e?p.emptyValue:e),onBlur:u&&(e=>u(E.id,e.target.value)),onFocus:m&&(e=>m(E.id,e.target.value))}))};var u=r(54639);function m({schema:e,uiSchema:t={},id:r,value:n,disabled:i,readonly:a,label:s,onBlur:d,onFocus:m,onChange:p}){const g=u.P6.schemaRequiresTrueValue(e),f=t["ui:description"]||e.description;return(0,l.createElement)(o.ToggleControl,{checked:n||!1,onChange:p,required:g,disabled:i,readOnly:a,label:s,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:d&&(e=>d(r,e.target.checked)),onFocus:m&&(e=>m(r,e.target.checked))})}function p({schema:e,uiSchema:t={},id:r,value:n,disabled:i,readonly:a,label:s,onBlur:d,onFocus:m,onChange:p}){const g=u.P6.schemaRequiresTrueValue(e),f=t["ui:description"]||e.description;return(0,l.createElement)(o.CheckboxControl,{checked:n||!1,onChange:p,required:g,disabled:i,readOnly:a,label:s,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:d&&(e=>d(r,e.target.checked)),onFocus:m&&(e=>m(r,e.target.checked))})}function g(e){const{disabled:t,options:r,value:n,readonly:i,onChange:a,label:s,schema:o,uiSchema:d={}}=e,{enumOptions:u,enumDisabled:m=[],enumDescriptions:p=[],style:g}=r,f=d["ui:description"]||o.description,h=u.map(((e,t)=>({...e,disabled:m.includes(e.value),help:p[t]&&(0,l.createElement)(c.Lu,{noWrap:!0,content:p[t]})})));return(0,l.createElement)(c.w2,{value:n||[],onChange:a,options:h,label:s||d["ui:title"]||o.title,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:f}),readOnly:i,disabled:t,style:g})}const{asNumber:f,guessType:h}=u.P6,E=new Set(["number","integer"]);function y(e,t){const{type:r,items:n}=e;if(""!==t){if("array"===r&&n&&E.has(n.type))return t.map(f);if("boolean"===r)return"true"===t;if("number"===r)return f(t);if(e.enum){if(e.enum.every((e=>"number"===h(e))))return f(t);if(e.enum.every((e=>"boolean"===h(e))))return"true"===t}return t}}function v(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const b=function(e){const{schema:t,uiSchema:r={},id:n,options:i,value:a,label:s,required:d,disabled:u,readonly:m,multiple:p,onChange:g,onBlur:f,onFocus:h,placeholder:E}=e,{enumOptions:b,enumDisabled:_}=i,x=p?[]:"",w=[];p||void 0!==t.default||w.push({value:"",label:E});for(const e of b)w.push({...e,disabled:_&&_.includes(e.value)});const C=r["ui:description"]||t.description;return(0,l.createElement)(o.SelectControl,{multiple:p,options:w,value:void 0===a?x:a,label:s,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:C}),required:d,disabled:u,readOnly:m,onChange:e=>g(y(t,e)),onBlur:f&&(e=>f(n,y(t,v(e,p)))),onFocus:h&&(e=>h(n,y(t,v(e,p))))})},{getUiOptions:_}=u.P6;function x({schema:e,uiSchema:t={},id:r,value:n,disabled:i,readonly:d,label:u,onBlur:m,onFocus:p,onChange:g,...f}){const h=_(t),{rows:E,placeholder:y,description:v=e.description}=h;return(0,l.createElement)(o.TextareaControl,(0,s.Z)({value:void 0===n?"":n,onChange:g,disabled:i,readOnly:d,label:u,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:v}),onBlur:m&&(e=>m(r,e.target.value)),onFocus:p&&(e=>p(r,e.target.value)),rows:E,placeholder:y},(0,a.without)(f,["autofocus","formContext","registry","rawErrors"])))}const{asNumber:w,guessType:C}=u.P6,S=new Set(["number","integer"]);function L(e,t){const{type:r,items:n}=e;if(""!==t){if("array"===r&&n&&S.has(n.type))return t.map(w);if("boolean"===r)return"true"===t;if("number"===r)return w(t);if(e.enum){if(e.enum.every((e=>"number"===C(e))))return w(t);if(e.enum.every((e=>"boolean"===C(e))))return"true"===t}return t}}function O({schema:e,uiSchema:t={},id:r,options:n,value:i,label:a,required:s,disabled:d,readonly:u,onChange:m,onBlur:p,onFocus:g}){const{enumOptions:f}=n,h=t["ui:description"]||e.description;return(0,l.createElement)(o.RadioControl,{selected:i,options:f,label:a,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:h}),required:s,disabled:d,readOnly:u,onChange:t=>m(L(e,t)),onBlur:p&&(t=>p(r,L(e,t.target.value))),onFocus:g&&(t=>g(r,L(e,t.target.value)))})}var N=r(95122),I=r(82839),T=r(81019);function k({id:e,disabled:t,options:r,value:n,onChange:i,schema:s,autofocus:c,readonly:d}){const{enumOptions:u,enumDisabled:m=[],excludeList:{title:p=(0,N.__)("Excluded","better-wp-security"),description:g=(0,N.__)("The list of items to exclude from the selection.","better-wp-security"),button:f=(0,N.__)("Include","better-wp-security")}={},includeList:{title:h=(0,N.__)("Included","better-wp-security"),description:E=(0,N.__)("The list of items to include in the selection.","better-wp-security"),button:y=(0,N.__)("Exclude","better-wp-security")}={},title:v=s.title,description:b=s.description}=r;(0,l.useEffect)((()=>{const e=u.map((e=>e.value)),t=n.filter((t=>e.includes(t)));t.length!==n.length&&i(t)}),[n,u,i]);const[_,x]=(0,a.partition)(u,(e=>!n.includes(e.value)));return(0,l.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},v&&(0,l.createElement)(o.BaseControl.VisualLabel,null,v),b&&(0,l.createElement)("p",null,b),(0,l.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:e},(0,l.createElement)(M,{id:e+"__exclude",options:_,label:p,description:g,button:f,disabled:t||d,disabledOptions:m,autofocus:c,onToggle:e=>{(0,I.speak)((0,N.sprintf)((0,N.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(_,{value:e}).label,h)),i([...n,e])}}),(0,l.createElement)(M,{id:e+"__include",options:x,label:h,description:E,button:y,disabled:t||d,disabledOptions:m,onToggle:e=>{(0,I.speak)((0,N.sprintf)((0,N.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(x,{value:e}).label,p)),i(n.filter((t=>t!==e)))}})))}function M({id:e,label:t,description:r,options:n,button:i,onToggle:s,disabled:d,disabledOptions:u=[],autofocus:m}){const p=e+"__option__",[g,f]=(0,l.useState)("");return g&&!(0,a.find)(n,{value:g})&&f(""),(0,l.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,l.createElement)(o.BaseControl,{id:e,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:r}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,l.createElement)("span",{className:"components-base-control__label",id:e+"__label"},t),(0,l.createElement)(c.T2,{role:"listbox",id:e,active:g&&p+g,"aria-labelledby":e+"__label","aria-describedby":r&&e+"__help",onNavigate:e=>f(e.substr(p.length)),onKeyDown:({keyCode:e})=>{if(!g||e!==T.DELETE&&e!==T.BACKSPACE)return;const t=(0,a.findIndex)(n,{value:g}),r=t+1<n.length?t+1:t-1;s(g),f(n[r]?.value||"")},autoFocus:m},n.map((e=>(0,l.createElement)("div",{id:p+e.value,key:e.value,role:d||u.includes(e.value)?"presentation":"option","aria-selected":e.value===g||void 0,onClick:d||u.includes(e.value)?void 0:()=>f(e.value)},e.label))))),(0,l.createElement)(o.Button,{variant:"secondary",disabled:!g,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>s(g),"aria-keyshortcuts":"Delete Backspace"},i))}const A="*";function R(e){const{id:t,title:r,required:n}=e;return(0,l.createElement)("span",{className:"itsec-rjsf-title-field",id:t},r,n&&(0,l.createElement)("span",{className:"required"},A))}var D=r(63263);const{getUiOptions:Z}=u.P6;function F({uiSchema:e,schema:t,idSchema:r,name:n,formData:i,disabled:a,readonly:s,onChange:o}){const c=Z(e);return(0,l.createElement)(D.fv,{id:r.$id,value:i,disabled:a,readonly:s,onChange:o,isMultiple:"array"===t.type,label:e["ui:title"]||t.title||n,description:e["ui:description"]||t.description,path:c.path,query:c.query,labelAttr:c.labelAttr,idAttr:c.idAttr,searchArg:c.searchArg})}const{getUiOptions:P}=u.P6;function H({uiSchema:e,schema:t,name:r,formData:n,disabled:i,readonly:a,onChange:s}){const o=e["ui:title"]||t.title||r,d=e["ui:description"]||t.description,u=P(e),{rows:m,placeholder:p}=u;return(0,l.createElement)(c.yA,{label:o,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:d}),disabled:i,readonly:a,rows:m,value:n,onChange:s,placeholder:p})}var V=r(87514),B=r.n(V),j=r(73470);function z({idSchema:e,formData:t,onChange:r,uiSchema:n,schema:i,name:s,disabled:d,readonly:u,autofocus:m}){const p=e.$id,g=n["ui:title"]||i.title||s,f=n["ui:description"]||i.description,[h,E]=(0,l.useState)([]),[y,v]=(0,l.useState)("");(0,l.useEffect)((()=>{B()({path:(0,j.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(E)}),[]);const b=e=>{r(t.includes(e)?t.filter((t=>t!==e)):[...t,e])};return(0,l.createElement)("div",{className:"itsec-rjsf-file-tree"},f&&(0,l.createElement)(c.Lu,{content:f,tagName:"p"}),(0,l.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,l.createElement)("div",null,(0,l.createElement)(c.mp,{tree:h,id:p,label:(0,N.__)("File Selector","better-wp-security"),active:y,setActive:v,onActivate:b,onLoad:async e=>{const t=await B()({path:(0,j.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),r=(0,a.cloneDeep)(h);(0,c.in)(r,(r=>{if(r.id===e)return r.children=t,c.in.halt})),E(r)}}),(0,l.createElement)(o.Button,{variant:"secondary",disabled:!y,className:"itsec-rjsf-file-tree__select",onClick:()=>b(y),"aria-keyshortcuts":"Enter Space"},(0,N.__)("Select","better-wp-security"))),(0,l.createElement)(c.yA,{value:t,onChange:r,className:"itsec-rjsf-file-tree__list",label:g,disabled:d,readonly:u,autoFocus:m})))}function $({name:e,...t}){return(0,l.createElement)(o.Fill,(0,s.Z)({name:`RjsfField${e}`},t))}function q({name:e,...t}){return(0,l.createElement)(o.Slot,(0,s.Z)({name:`RjsfField${e}`},t))}const{ADDITIONAL_PROPERTY_FLAG:U,getUiOptions:W}=u.P6;function G(e){const{id:t,classNames:r,disabled:n,label:i,onKeyChange:a,onDropPropertyClick:s,readonly:c,required:d,schema:u,uiSchema:m}=e,p=`${i} Key`,g=u.hasOwnProperty(U),{removable:f}=W(m);return g&&!1!==f?(0,l.createElement)("div",{className:r},(0,l.createElement)("div",{className:"row"},(0,l.createElement)("div",{className:"col-xs-5 form-additional"},(0,l.createElement)(o.TextControl,{label:p,required:d,id:`${t}-key`,onBlur:e=>a(e.target.value)})),(0,l.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,l.createElement)("div",{className:"col-xs-2"},(0,l.createElement)(o.Button,{icon:"no-alt",isDestructive:!0,disabled:n||c,onClick:s(i)})))):(0,l.createElement)("div",{className:r},e.children)}const{canExpand:K}=u.P6;function Y({className:e,onClick:t,disabled:r}){return(0,l.createElement)("div",{className:"row"},(0,l.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`},(0,l.createElement)(o.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,N.__)("Add","better-wp-security"),tabIndex:"0",onClick:t,disabled:r})))}const Q={FieldTemplate:function(e){const{children:t,errors:r,hidden:n,schema:i,uiSchema:a,formContext:s,onChange:c}=e;if(n)return null;const{resettable:d}=W(a);return(0,l.createElement)(G,e,t,(0,l.createElement)(q,{name:e.id,fillProps:e}),d&&(0,l.createElement)(o.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>c(i.default)},(0,N.__)("Restore Default","better-wp-security")),!0!==s?.disableInlineErrors&&r)},ObjectFieldTemplate:function(e){const{TitleField:t,DescriptionField:r,schema:n,uiSchema:i,properties:a}=e;if(!a.length)return null;const s=(i["ui:sections"]||[]).reduce(((e,t)=>({...e,[t.fields.find((e=>!!n.properties[e]))]:t})),{});return(0,l.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:e.idSchema.$id},(i["ui:title"]||e.title)&&(0,l.createElement)(t,{id:`${e.idSchema.$id}__title`,title:e.title||i["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,l.createElement)(r,{id:`${e.idSchema.$id}__description`,description:(0,l.createElement)(c.Lu,{noWrap:!0,content:e.description}),formContext:e.formContext}),a.map((({name:e,content:t})=>s[e]?(0,l.createElement)(l.Fragment,{key:e},(0,l.createElement)("h3",{className:"itsec-rjsf-section-title"},s[e].title),s[e].description&&(0,l.createElement)("p",{className:"itsec-rjsf-section-description"},(0,l.createElement)(c.Lu,{noWrap:!0,content:s[e].description})),t):t)),K(n,i,e.formData)&&(0,l.createElement)(Y,{className:"object-property-expand",onClick:e.onAddClick(n),disabled:e.disabled||e.readonly}))},ErrorList:function({errors:e}){return(0,l.createElement)(c.KM,{errors:e.map((({stack:e}={})=>e)).filter((e=>!!e))})},widgets:n,fields:i},X=Q},50460:(e,t,r)=>{"use strict";r.d(t,{G:()=>P,o:()=>I});var n={};r.r(n),r.d(n,{REGISTER_PROVIDER:()=>D,registerProvider:()=>R});var i={};r.r(i),r.d(i,{getProviders:()=>Z});var a=r(87462),s=r(6293),l=r(73727),o=r(16550),c=r(90071),d=r(92819),u=r(64893),m=r(95122),p=r(48015),g=r(9576),f=r(81019),h=r(82839),E=r(71930),y=r(8476),v=r(36179),b=r(86033),_=r(13092);function x(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var w=new WeakMap,C=new WeakMap,S=new WeakMap,L=new WeakMap,O=new WeakMap;class N{constructor(e,t){x(this,w,{writable:!0,value:void 0}),x(this,C,{writable:!0,value:void 0}),x(this,S,{writable:!0,value:void 0}),x(this,L,{writable:!0,value:void 0}),x(this,O,{writable:!0,value:void 0}),(0,_.Z)(this,w,e),(0,_.Z)(this,C,t),(0,_.Z)(this,S,t.select(P).getProviders()),this._prepare()}_prepare(){(0,_.Z)(this,O,(0,b.Z)(this,w).split(/\s+/g).map((e=>e.trim().toLowerCase())).filter((e=>!!e)));const e=(0,b.Z)(this,w).endsWith(" ");(0,_.Z)(this,L,new RegExp((0,b.Z)(this,O).map(((t,r)=>r+1!==(0,b.Z)(this,O).length||e?`(?=.*\\b${(0,d.escapeRegExp)(t)}\\b)`:`(?=.*\\b${(0,d.escapeRegExp)(t)})`)).join("")+".+","gi"))}_stringMatch(e){return e&&(0,b.Z)(this,L).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some((e=>(0,b.Z)(this,O).some(((t,r)=>e.includes(" ")?this._stringMatch(e):r===(0,b.Z)(this,O).length-1?e.startsWith(t):t===e))))}getResults(){if((0,b.Z)(this,w).length<3)return[{},0];let e=0;const t=[],r={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const n of(0,b.Z)(this,S)){const i={title:n.title,items:[],groups:{}};e+=n.callback({evaluate:r,results:i,registry:(0,b.Z)(this,C)}),!i.items.length&&(0,d.isEmpty)(i.groups)||t.push(i)}return[t,e]}}const I=(0,s.forwardRef)((function({onPick:e=d.noop,showResults:t},r){const[n,i]=(0,s.useState)(""),[l,o]=(0,s.useState)(!1),c=(0,s.useRef)(),u=(0,s.useRef)(),[v,b]=(0,s.useState)([]),_=(0,p.useRegistry)(),x=(0,s.useCallback)((e=>{const t=new N(e,_).getResults();b(t[0]),(0,h.speak)((0,m.sprintf)((0,m._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))}),[_]),w=(0,g.useDebounce)(x,50),C=(0,s.useCallback)((e=>{c.current&&(e.preventDefault(),c.current.focus())}),[c]);return(0,g.useKeyboardShortcut)("/",C),(0,s.createElement)("div",(0,a.Z)({className:"itsec-search"},(0,y.Zk)((()=>o(!1)))),(0,s.createElement)("div",null,(0,s.createElement)(E.lD,{value:n,onChange:e=>{i(e),w(e)},onFocus:()=>o(!0),onKeyDown:e=>{e.keyCode===f.DOWN&&(e.preventDefault(),u.current.focus())},ref:(0,y.qq)([r,c]),placeholder:(0,m.__)("Search for features, settings, and more","better-wp-security"),omitSeparators:!0,size:"large"}),(l||t)&&n.length>=3&&(0,s.createElement)(T,{results:v,exitSearch:t=>{e(t),o(!1)},ref:u,onPick:e})))})),T=(0,s.forwardRef)((function({results:e,exitSearch:t,onPick:r},n){const i=(0,s.useRef)();(0,s.useImperativeHandle)(n,(()=>({focus(){i.current.focus()}})));const l=(0,g.useInstanceId)(T,"itsec-search"),p=l+"__result__",h=function(){const e=(0,o.k6)();return(t,r="push")=>e[r]((0,c.ob)(t))}(),[E,y]=(0,s.useState)("");return(0,d.isEmpty)(e)?null:(0,s.createElement)(React.Fragment,null,(0,s.createElement)(u.VisuallyHidden,{id:l+"__label"},(0,m.__)("Search Results","better-wp-security")),(0,s.createElement)(v.T2,{className:"itsec-search__results",id:l,active:E&&p+E,onNavigate:e=>y(e.substring(p.length)),onKeyDown:({keyCode:e})=>{!E||e!==f.ENTER&&e!==f.SPACE||(r(E),h(E),t())},onFocus:()=>{if(!E&&!(0,d.isEmpty)(e)){const[,t]=Object.entries(e)[0];if(t.items?.length)y(t.items[0].route);else if(!(0,d.isEmpty)(t.groups)){const[,e]=Object.entries(t.groups)[0];y(e.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:i,"aria-labelledby":l+"__label"},(0,d.map)(e,((e,r)=>(0,s.createElement)(k,(0,a.Z)({key:r},e,{active:E,idPrefix:p,exitSearch:t}))))))}));function k({title:e,items:t,groups:r,...n}){const i=(0,g.useInstanceId)(T,"itsec-search__kind");return(0,s.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":i},(0,s.createElement)("li",{role:"presentation",id:i},e),(t||[]).map((e=>(0,s.createElement)(A,(0,a.Z)({key:e.route},e,n)))),(0,d.map)(r,((e,t)=>(0,s.createElement)(M,(0,a.Z)({key:t},e,n)))))}function M({title:e,items:t,...r}){const n=(0,g.useInstanceId)(T,"itsec-search__group");return(0,s.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":n},(0,s.createElement)("li",{role:"presentation",id:n},(0,s.createElement)("span",null,e)),(t||[]).map((e=>(0,s.createElement)(A,(0,a.Z)({key:e.route},e,r)))))}function A({title:e,description:t,route:r,active:n,idPrefix:i,exitSearch:a}){return(0,s.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":n===r||void 0,id:i+r,"aria-label":e},(0,s.createElement)(l.rU,{to:r,tabIndex:-1,onClick:()=>a(r)},(0,s.createElement)("span",null,e),(0,s.createElement)(v.Lu,{content:t,noHtml:!0,tagName:"p"})))}function R(e,t,r,n){return{type:D,slug:e,title:t,priority:r,callback:n}}const D="REGISTER_PROVIDER",Z=(0,r(28306).Z)((e=>(0,d.sortBy)(e.providers,"priority")),(e=>e.providers)),F={providers:{}},P="ithemes-security/search";(0,p.registerStore)(P,{actions:n,selectors:i,reducer:function(e=F,t){return t.type===D?{...e,providers:{...e.providers,[t.slug]:(0,d.omit)(t,["type"])}}:e}})},63263:(e,t,r)=>{"use strict";r.d(t,{U9:()=>we,qb:()=>g,kS:()=>Ee,fv:()=>x,KM:()=>S,nU:()=>re,TR:()=>le,Lu:()=>k,uC:()=>ee,T:()=>F,b:()=>P,_g:()=>J,ge:()=>W,Qf:()=>G,oB:()=>Ce});var n=r(87462),i=r(6293),a=r(99196),s=r(35800),l=r(18526),o=r(29508),c=r(64893),d=r(95122);const u=(0,a.lazy)((()=>r.e(5544).then(r.bind(r,85544))));function m(){return(0,i.createElement)("span",null,(0,d.__)("Error when loading. Please refresh.","better-wp-security"))}const p=(0,o.iv)({name:"8ddf6o",styles:"input:focus{box-shadow:none;}"});function g({addErrorBoundary:e=!0,className:t,...r}){const d=(0,l.u)(),g=(0,i.createElement)(a.Suspense,{fallback:(0,i.createElement)(c.Spinner,null)},(0,i.createElement)(u,(0,n.Z)({},r,{className:(0,o.cx)(t,p),theme:e=>({...e,colors:{...e.colors,primary:d.colors.primary.base,primary75:d.colors.secondary.base,primary50:d.colors.tertiary.base,primary25:d.colors.surface.secondary}})})));return e?(0,i.createElement)(s.ErrorBoundary,{FallbackComponent:m},g):g}var f=r(62845),h=r(92819),E=r(87514),y=r.n(E),v=r(73470),b=r(9576);const{useGlobalState:_}=(0,f.r8)({cache:{}});function x({id:e,value:t,disabled:r,readonly:n,onChange:a,label:s,description:l,isMultiple:o=!1,path:d,query:u={},labelAttr:m,idAttr:p="id",searchArg:f="search"}){const[E,w]=_("cache"),C=(0,b.useInstanceId)(x,"itsec-entity-select-control");e=e||C;const[S,L]=(0,i.useState)(""),O=function(e,t,r,n,a,s,l){return(0,i.useCallback)((i=>y()({path:(0,v.addQueryArgs)(e,{...t,[a]:i})}).then((e=>e.map((e=>({value:e[n],label:e[r]}))))).then((t=>(l({...s,[e]:{...s[e]||{},...(0,h.mapValues)((0,h.keyBy)(t,"value"),"label")}}),t)))),[e,t,r,n,a,s,l])}(d,u,m,p,f,E,w);let N;return o?N=(t||[]).filter((e=>void 0!==e)).map((e=>({value:e,label:E[d]?.[e]||e}))):t&&(N={value:t,label:E[d]?.[t]||t}),(0,i.createElement)(c.BaseControl,{className:"itsec-entity-select-control",label:s,help:l&&(0,i.createElement)(k,{noWrap:!0,content:l}),id:e,__nextHasNoMarginBottom:!0},(0,i.createElement)(g,{"aria-label":s,"aria-describedby":l?e+"__help":void 0,classNamePrefix:"itsec-entity-select-control-as",inputId:e,isDisabled:r||n,isMulti:o,isClearable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:O,value:N,onChange:e=>a(o?(e||[]).map((e=>e.value)):e?.value),inputValue:S,onInputChange:L}))}var w=r(71930),C=r(31511);function S({errors:e,apiError:t,schemaError:r,title:n,className:a,hasBorder:s}){const l=[...e||[],...(0,C.Y3)(t),...(r||[]).map((e=>e.stack))];return l.length?(0,i.createElement)(w.rN,{messages:l,heading:n,className:a,hasBorder:s,type:"danger"}):null}var L=r(52117);const O=(0,L.Z)("div",{target:"e103ploj0"})({name:"1ff36h2",styles:"flex-grow:1"});function N(){return(0,i.createElement)(O,{"aria-hidden":!0})}var I=r(63108),T=r(73727);function k({transform:e,...t}){return(0,i.createElement)(I.Lu,(0,n.Z)({},t,{transform:(r,n)=>{if(e){const t=e(r,n);if(void 0!==t)return t}if("a"===r.tagName.toLowerCase()&&r.dataset.itsecPath&&!t.noHtml)return(0,i.createElement)(T.rU,{to:r.dataset.itsecPath},n)}}))}var M=r(8476),A=r(54639),R=r(33590);const D=(0,A.Zz)(R.ZP),Z=(0,L.Z)(D,{target:"e1yg558d0"})(".itsec-rjsf-object-fieldset{display:grid;grid-template-columns:[label fields] minmax(0, 1fr);grid-template-rows:auto;grid-gap:.5rem 0;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){grid-template-columns:[label] 10rem [fields] minmax(0, 1fr);}}.itsec-rjsf-section-description{margin-top:0;grid-column:fields;}>.field-object>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field,&>.itsec-rjsf-section-title{grid-column:label;font-size:1rem;padding-right:1rem;margin-bottom:0;&:not(:first-child){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){&+*{border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;}}}}&>.form-group:not(.field-object){grid-column:label/fields-end;}&>.itsec-rjsf-section-title~.form-group{grid-column:fields;}&>.field-object{grid-column:label/fields-end;}&>.field-description{margin-top:0;}}.itsec-rjsf-object-fieldset>*>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field{grid-column:label;font-size:1rem;padding-right:1rem;}&>.form-group{grid-column:fields;}&>.field-description{grid-column:fields;margin-top:0;}}.components-base-control__label,.components-input-control__label,label,caption,legend{color:",(({theme:e})=>e.colors.text.dark),";}.itsec-highlighted-search-result{.components-base-control__label,.components-input-control__label,label,caption{border-bottom:3px solid ",(({theme:e})=>e.colors.border.info),";padding-bottom:3px;margin-bottom:6px;}.components-base-control__field{margin-bottom:12px;}}.field-object:not(:first-child):not(:empty){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:1rem;padding-top:1rem;}.field-object:empty{display:none;}.itsec-rjsf-title-field+.field-object:not(:first-child),.itsec-rjsf-section-description+.field-object:not(:first-child){border-top:none;margin-top:0;padding-top:0;}");function F({saveLabel:e,isSaving:t,saveDisabled:r,cancelLabel:a,onCancel:s,cancelRoute:l,undoLabel:o,undoDisabled:d,onUndo:u,children:m,errors:p,apiError:g,schemaError:f,withCard:h,alignActions:E,...y}){let v=(0,b.useInstanceId)(F,"itsec-schema-form");v=y.id||v;const _=(0,i.createElement)(React.Fragment,null,(0,i.createElement)(S,{errors:p,apiError:g,schemaError:f}),(0,i.createElement)(P,(0,n.Z)({},y,{id:v})));return(0,i.createElement)(c.Flex,{direction:"column",gap:7,justify:"start",expanded:!1},(0,i.createElement)(c.FlexItem,null,h&&(0,i.createElement)(c.Card,null,(0,i.createElement)(c.CardBody,null,_)),!h&&_),(0,i.createElement)(c.FlexItem,null,(0,i.createElement)(H,{id:v,saveLabel:e,cancelLabel:a,isSaving:t,saveDisabled:r,onCancel:s,cancelRoute:l,undoLabel:o,undoDisabled:d,onUndo:u,align:E},m)))}function P({className:e,...t}){return(0,i.createElement)(Z,(0,n.Z)({},t,{className:e,additionalMetaSchemas:[r(27171)]}),(0,i.createElement)(React.Fragment,null))}function H({id:e,saveLabel:t=(0,d.__)("Save","better-wp-security"),isSaving:r,saveDisabled:n,cancelLabel:a=(0,d.__)("Cancel","better-wp-security"),onCancel:s,cancelRoute:l,undoLabel:o=(0,d.__)("Undo Changes","better-wp-security"),undoDisabled:u,onUndo:m,align:p,children:g}){return(0,i.createElement)(c.Flex,{align:p},s&&(0,i.createElement)(c.FlexItem,null,(0,i.createElement)(w.zx,{variant:"tertiary",type:"button",onClick:s},a)),l&&(0,i.createElement)(c.FlexItem,null,(0,i.createElement)(T.rU,{component:(0,M.Sj)(w.zx),variant:"tertiary",type:"button",to:l},a)),!p&&(0,i.createElement)(N,null),g,m&&(0,i.createElement)(c.FlexItem,null,(0,i.createElement)(w.zx,{variant:"secondary",disabled:u,onClick:m},o)),(0,i.createElement)(c.FlexItem,null,(0,i.createElement)(w.zx,{variant:"primary",isBusy:r,disabled:r||n,form:e,type:"submit"},t)))}var V=r(32010),B=r(60976);const j=(0,L.Z)(w.Tg,{target:"ecpy66c3"})({name:"1x94tvs",styles:"display:flex;align-items:center;flex-shrink:0;padding:.5rem 1.5rem;min-height:calc(30px + 1rem);& .components-button:focus{box-shadow:none;}"}),z=(0,L.Z)(c.Toolbar,{target:"ecpy66c2"})({name:"gxzf6f",styles:"border:none;max-width:100%;margin-left:auto"}),$=(0,L.Z)("div",{target:"ecpy66c1"})({name:"hlx1h5",styles:"display:flex;gap:0.5rem;margin:0 2rem 0 1rem;flex-grow:1"}),q=(0,L.Z)(B.Ae,{target:"ecpy66c0"})({name:"1jxlbx4",styles:"height:2rem;width:2rem"});function U({area:e,...t}){return(0,i.createElement)(c.Slot,(0,n.Z)({name:`Toolbar${e}`},t))}function W({area:e="actions",...t}){return(0,i.createElement)(c.Fill,(0,n.Z)({name:`Toolbar${e}`},t))}function G(){const e=(0,C.bv)("dashboard"),t=(0,b.useViewportMatch)("medium","<");return(0,i.createElement)(j,{role:"region","aria-label":(0,d.__)("Toolbar","better-wp-security")},t?(0,i.createElement)(q,null):(0,i.createElement)(le,null),(0,i.createElement)(U,{area:"main"},(e=>(0,i.createElement)($,null,e))),(0,i.createElement)(z,{label:(0,d.__)("Toolbar Actions","better-wp-security")},(0,i.createElement)(c.ToolbarButton,{icon:V.Z,href:e,text:(0,d.__)("Dashboard","better-wp-security")}),(0,i.createElement)(U,{area:"actions"})))}const K=(0,L.Z)("nav",{target:"e28bhoc2"})("display:flex;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),Y=(0,L.Z)(T.OL,{target:"e28bhoc1"})("display:flex;text-decoration:none;align-items:center;&.active{box-shadow:inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),";}&:focus{color:",(({theme:e})=>e.colors.text.dark),";box-shadow:inset 0 0 0 2px ",(({theme:e})=>e.colors.border.info),",inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),"!important;border-radius:3px!important;}"),Q=(0,L.Z)(w.xv,{target:"e28bhoc0"})({name:"1i2l0vb",styles:"padding:.75rem 1.25rem"}),X=(0,i.createContext)({size:w.yH.LARGE});function J({className:e,size:t=w.yH.LARGE,children:r}){const n=(0,i.useMemo)((()=>({size:t})),[t]);return(0,i.createElement)(K,{className:e},(0,i.createElement)(X.Provider,{value:n},r))}function ee({title:e,...t}){const{size:r}=(0,i.useContext)(X);return(0,i.createElement)(Y,t,(0,i.createElement)(Q,{size:r,weight:w.fs.HEAVY,text:e,align:"center"}))}const te=(0,L.Z)(B.Ae,{shouldForwardProp:e=>"isSmall"!==e,target:"ewrt4zq0"})("height:",(({isSmall:e})=>e?"56px":"120px"),";width:",(({isSmall:e})=>e?"56px":"120px"),";");function re({icon:e,isSmall:t=!1}){return(0,b.useMediaQuery)("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)")?e:(0,i.createElement)(te,{isSmall:t})}var ne=r(48015),ie=r(31600);const ae=(0,L.Z)(B.sX,{target:"e1bzve6y1"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;"),se=(0,L.Z)(B.Pb,{target:"e1bzve6y0"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;");function le({size:e=25,className:t}){const{installType:r}=(0,ne.useSelect)((e=>({installType:e(ie.coreStore).getInstallType()})),[]);return"free"===r?(0,i.createElement)(ae,{size:e,className:t}):(0,i.createElement)(se,{size:e,className:t})}var oe=r(59588),ce=r.n(oe),de=r(76292),ue=r.n(de),me=r(82506),pe=r(82521);const ge=(0,L.Z)("div",{target:"e1hwued11"})({name:"aj6rbz",styles:"display:flex;gap:0.5rem"}),fe=(0,L.Z)(w.zx,{target:"e1hwued10"})({name:"1o3nkn",styles:"margin-left:auto"}),he=ce()((()=>[{value:"24-hours",label:(0,d.__)("24 Hours","better-wp-security")},{value:"week",label:(0,d.__)("7 Days","better-wp-security")},{value:"30-days",label:(0,d.__)("30 Days","better-wp-security")},{value:"custom",label:(0,d.__)("Custom","better-wp-security")}]));function Ee({value:e,onChange:t}){const[r,n]=(0,i.useState)(!1),[a,s]=(0,i.useState)(void 0),[l,o]=(0,i.useState)(void 0);let[u,m]=(0,i.useState)(void 0);const p=e,g=function(e){if(!e)return"";const t=new window.Date;let r,n;switch(e){case"24-hours":return(0,d.__)("24 Hours","better-wp-security");case"30-days":r=(0,pe.dateI18n)("M j",t.setDate(t.getDate()-30)),n=(0,pe.dateI18n)("M j, Y");break;case"week":r=(0,pe.dateI18n)("M j",t.setDate(t.getDate()-7)),n=(0,pe.dateI18n)("M j, Y");break;default:r=(0,pe.dateI18n)("M j",e.start),n=(0,pe.dateI18n)("M j, Y",e.end)}return(0,d.sprintf)((0,d.__)("%1$s - %2$s","better-wp-security"),r,n)}(p);return u=u||((0,h.isString)(p)?p:"custom"),(0,i.createElement)("div",null,(0,i.createElement)(w.zx,{onClick:()=>n(!r),title:g,"aria-expanded":r,"aria-label":(0,d.sprintf)((0,d.__)("%s (click to edit)","better-wp-security"),g),variant:"tertiary",text:g,icon:me.Z,iconPosition:"right"}),r&&(0,i.createElement)(c.Modal,{title:(0,d.__)("Change Date Period","better-wp-security"),onRequestClose:()=>n(!1)},(0,i.createElement)(c.SelectControl,{options:he(),value:u,onChange:e=>m(e)}),(0,i.createElement)(ge,null,"custom"===u&&(0,i.createElement)(React.Fragment,null,(0,i.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,i.createElement)(w.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,d.sprintf)((0,d.__)("From: %s (click to edit","better-wp-security"),(0,pe.dateI18n)("M j",a)),text:(0,d.sprintf)((0,d.__)("From %s","better-wp-security"),(0,pe.dateI18n)("M j",a))}),renderContent:()=>(0,i.createElement)(c.DatePicker,{currentDate:a,onChange:s,isInvalidDate:e=>{if((0,pe.isInTheFuture)(e))return!0;const t=new window.Date;return t.setDate(t.getDate()-60),e<t}})}),(0,i.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,i.createElement)(w.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,d.sprintf)((0,d.__)("To: %s (click to edit","better-wp-security"),(0,pe.dateI18n)("M j",l)),text:(0,d.sprintf)((0,d.__)("To: %s (click to edit","better-wp-security"),(0,pe.dateI18n)("M j",l))}),renderContent:()=>(0,i.createElement)(c.DatePicker,{currentDate:l,onChange:o,isInvalidDate:e=>!!(0,pe.isInTheFuture)(e)||(0,pe.getDate)(a)>e})})),(0,i.createElement)(fe,{variant:"primary",onClick:e=>{let r;if(e.preventDefault(),"custom"===u){const e=ue()(a).set({hour:0,minute:0,second:0}),t=ue()(l).set({hour:23,minute:59,second:59});r={start:(0,pe.format)("Y-m-d\\TH:i:s",e),end:(0,pe.format)("Y-m-d\\TH:i:s",t)}}else r=u;t(r),n(!1)},text:(0,d.__)("Apply","better-wp-security")}))))}const ye=(0,L.Z)(c.Icon,{target:"e1vmfdpe1"})({name:"1svyz14",styles:"background-color:#438C56;border-radius:2rem"}),ve=(0,L.Z)(c.Icon,{target:"e1vmfdpe0"})({name:"x749hy",styles:"background-color:#E6505466;border-radius:2rem;height:0.813rem!important;width:0.813rem!important;padding:2px"});var be=r(28184),_e=r(65202),xe=r(67527);function we(){const{versionActive:e,versionSettings:t,installType:r}=(0,ne.useSelect)((e=>({versionActive:e(ie.modulesStore).isActive("version-management"),versionSettings:e(ie.modulesStore).getSettings("version-management"),installType:e(ie.coreStore).getInstallType()})),[]),n=e&&t.update_if_vulnerable,a="free"===r,s=n?(0,d.__)("Real-Time Updates Active","better-wp-security"):(0,d.__)("Real-Time Updates Inactive","better-wp-security"),l=a?(0,d.__)("Upgrade","better-wp-security"):(0,d.__)("Enable “Auto Update If Fixes Vulnerability” in Version Management","better-wp-security"),o=n?(0,i.createElement)(ye,{icon:be.Z}):(0,i.createElement)(ve,{icon:_e.Z,style:{fill:"#8A2424"}});return(0,i.createElement)(w.Ct,{text:s,icon:o,iconColor:"#FFFFFF",tooltip:l})}function Ce(){const{hasPatchstack:e,installType:t}=(0,ne.useSelect)((e=>({hasPatchstack:e(ie.coreStore).hasPatchstack(),installType:e(ie.coreStore).getInstallType()})),[]),r="free"===t,n=e?(0,d.__)("Virtual Patching Active","better-wp-security"):(0,d.__)("Virtual Patching Inactive","better-wp-security"),a=r?(0,d.__)("Upgrade","better-wp-security"):null,s=e?xe.Z:(0,i.createElement)(ve,{icon:_e.Z,style:{fill:"#8A2424"}});return(0,i.createElement)(w.Ct,{text:n,icon:s,iconColor:"#6817C5",tooltip:a})}},52278:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"}))},63708:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"}))},83904:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)(i.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"}))},96015:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)(i.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"}))},27231:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}))},36058:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"}))},28306:(e,t,r)=>{"use strict";var n,i;function a(e){return[e]}function s(){var e={clear:function(){e.head=null}};return e}function l(e,t,r){var n;if(e.length!==t.length)return!1;for(n=r;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function o(e,t){var r,o;function c(){r=i?new WeakMap:s()}function d(){var r,n,i,a,s,c=arguments.length;for(a=new Array(c),i=0;i<c;i++)a[i]=arguments[i];for(s=t.apply(null,a),(r=o(s)).isUniqueByDependants||(r.lastDependants&&!l(s,r.lastDependants,0)&&r.clear(),r.lastDependants=s),n=r.head;n;){if(l(n.args,a,1))return n!==r.head&&(n.prev.next=n.next,n.next&&(n.next.prev=n.prev),n.next=r.head,n.prev=null,r.head.prev=n,r.head=n),n.val;n=n.next}return n={val:e.apply(null,a)},a[0]=null,n.args=a,r.head&&(r.head.prev=n,n.next=r.head),r.head=n,n.val}return t||(t=a),o=i?function(e){var t,i,a,l,o,c=r,d=!0;for(t=0;t<e.length;t++){if(!(o=i=e[t])||"object"!=typeof o){d=!1;break}c.has(i)?c=c.get(i):(a=new WeakMap,c.set(i,a),c=a)}return c.has(n)||((l=s()).isUniqueByDependants=d,c.set(n,l)),c.get(n)}:function(){return r},d.getDependants=t,d.clear=c,c(),d}r.d(t,{Z:()=>o}),n={},i="undefined"!=typeof WeakMap},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},25993:e=>{e.exports=function(){return this.wp.domReady}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},25703:e=>{e.exports=function(){return this.wp.notices}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash},76292:e=>{"use strict";e.exports=window.moment}},e=>{e.O(0,[7271,1930,5307,9443,135,9071,976,6179],(()=>(12032,e(e.s=12032))));var t=e.O();((window.itsec=window.itsec||{}).pages=window.itsec.pages||{}).settings=t}]);
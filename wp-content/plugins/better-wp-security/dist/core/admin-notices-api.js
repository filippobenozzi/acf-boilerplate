(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[8689,1511],{76864:(t,e,i)=>{"use strict";i.r(e),i.d(e,{store:()=>V});var n={};i.r(n),i.d(n,{FAILED_NOTICE_ACTION:()=>C,FAILED_UPDATE_MUTED_HIGHLIGHT:()=>Z,FINISH_NOTICE_ACTION:()=>v,FINISH_UPDATE_MUTED_HIGHLIGHT:()=>S,RECEIVE_MUTED_HIGHLIGHTS:()=>N,RECEIVE_NOTICES:()=>O,START_NOTICE_ACTION:()=>b,START_UPDATE_MUTED_HIGHLIGHT:()=>w,doNoticeAction:()=>A,failedNoticeAction:()=>I,failedUpdateMutedHighlight:()=>T,finishNoticeAction:()=>m,finishUpdateMutedHighlight:()=>_,receiveMutedHighlights:()=>y,receiveNotices:()=>f,startNoticeAction:()=>p,startUpdateMutedHighlight:()=>E,updateMutedHighlight:()=>H});var r={};i.r(r),i.d(r,{areNoticesLoaded:()=>F,getInProgressActions:()=>L,getMutedHighlightUpdatesInFlight:()=>j,getMutedHighlights:()=>x,getNotices:()=>P,isDoingAction:()=>R,isNoticeDismissed:()=>D,isResolved:()=>M,isResolving:()=>U});var s={};i.r(s),i.d(s,{getMutedHighlights:()=>$,getNotices:()=>W});var o=i(48015),c=i(92819),a=i(87514),u=i.n(a),d=i(54761),h=i(31511);function l(t){return{type:"API_FETCH",request:t}}const g={API_FETCH:({request:t})=>u()(t).catch(h.xJ),SELECT:({selectorName:t,args:e})=>(0,o.select)("ithemes-security/admin-notices")[t](...e),CREATE_NOTICE({status:t,content:e,options:i}){i.autoDismiss&&(i.id=i.id||(0,c.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,o.dispatch)("core/notices").removeNotice(i.id,i.context)),i.autoDismiss)),(0,o.dispatch)("core/notices").createNotice(t,e,i)},DO_ACTION:(0,o.createRegistryControl)((t=>({action:e,args:i})=>{(0,d.doAction)(`ithemes-security.${e}`,t,...i)}))};function f(t){return{type:O,notices:t}}function p(t,e){return{type:b,noticeId:t,actionId:e}}function m(t,e,i){return{type:v,noticeId:t,actionId:e,response:i}}function I(t,e,i){return{type:C,noticeId:t,actionId:e,error:i}}function y(t){return{type:N,mutedHighlights:t}}function E(t,e){return{type:w,slug:t,mute:e}}function _(t,e){return{type:S,slug:t,mute:e}}function T(t,e,i){return{type:Z,slug:t,mute:e,error:i}}function*A(t,e,i={}){let n;yield p(t,e),yield function(t,...e){return{type:"DO_ACTION",action:"admin-notices.triggerAction",args:e}}(0,t,e,i);try{n=yield l({path:`/ithemes-security/v1/admin-notices/${t}/${e}`,method:"POST",data:i})}catch(i){return yield I(t,e,i),i}return yield m(t,e,n),n}function*H(t,e){let i;yield E(t,e);try{i=yield l({path:"/ithemes-security/v1/admin-notices/settings",method:"PUT",data:{muted_highlights:{[t]:e}}})}catch(i){return yield T(t,e,i),i}return yield _(t,e),i}const O="RECEIVE_NOTICES",b="START_NOTICE_ACTION",v="FINISH_NOTICE_ACTION",C="FAILED_NOTICE_ACTION",N="RECEIVE_MUTED_HIGHLIGHTS",w="START_UPDATE_MUTED_HIGHLIGHT",S="FINISH_UPDATE_MUTED_HIGHLIGHT",Z="FAILED_UPDATE_MUTED_HIGHLIGHT";function U(t,...e){return(0,o.select)("core/data").isResolving("ithemes-security/admin-notices",t,e)}function M(t,...e){return(0,o.select)("core/data").hasFinishedResolution("ithemes-security/admin-notices",t,e)}function P(t){return t.notices}function D(t,e){return!t.notices.find((t=>t.id===e))}function F(){return M("getNotices")}function R(t,e,i=""){return!!t.doingActions[e]&&(""===i||t.doingActions[e].includes(i))}const k=[];function L(t,e){return t.doingActions[e]||k}function x(t){return t.mutedHighlights}function j(t){return t.mutedHighlightUpdatesInFlight}const G={notices:[],doingActions:{},mutedHighlights:{},mutedHighlightUpdatesInFlight:{}},W={*fulfill(){const t=yield l({path:"/ithemes-security/v1/admin-notices"});yield f(t)},shouldInvalidate:t=>t.type===v||t.type===S};function*$(){const t=yield l({path:"/ithemes-security/v1/admin-notices/settings"});yield y((0,c.isEmpty)(t.muted_highlights)?{}:t.muted_highlights)}const J=(0,o.createReduxStore)("ithemes-security/admin-notices",{controls:g,actions:n,selectors:r,resolvers:s,reducer:function(t=G,e){switch(e.type){case O:return{...t,notices:[...e.notices]};case b:return{...t,doingActions:{...t.doingActions,[e.noticeId]:[...t.doingActions[e.noticeId]||[],e.actionId]}};case v:case C:return{...t,doingActions:{...t.doingActions,[e.noticeId]:(t.doingActions[e.noticeId]||[]).filter((t=>t!==e.actionId))}};case N:return{...t,mutedHighlights:e.mutedHighlights};case w:return{...t,mutedHighlightUpdatesInFlight:{...t.mutedHighlightUpdatesInFlight,[e.slug]:{mute:e.mute}}};case S:return{...t,mutedHighlightUpdatesInFlight:(0,c.omit)(t.mutedHighlightUpdatesInFlight,e.slug),mutedHighlights:{...t.mutedHighlights,[e.slug]:e.mute}};case Z:return{...t,mutedHighlightUpdatesInFlight:(0,c.omit)(t.mutedHighlightUpdatesInFlight,e.slug)};default:return t}}});(0,o.register)(J);const V=J;i.p=window.itsecWebpackPublicPath},31511:(t,e,i)=>{"use strict";i.d(e,{sE:()=>C,x4:()=>I,PN:()=>p,pL:()=>b,NC:()=>H,N4:()=>O,g4:()=>D,bK:()=>F,Rg:()=>S,CO:()=>Z,AW:()=>w,SU:()=>N,k0:()=>A,ZE:()=>T,UC:()=>U,xJ:()=>v,z8:()=>_,VG:()=>P,Y3:()=>M,bv:()=>E});var n=i(92819),r=i(65096),s=i.n(r),o=i(6293),c=i(73470),a=i(95122),u=i(4942),d=i(13092),h=i(86033);function l(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}var g=new WeakMap,f=new WeakMap;class p{constructor(t=void 0,e=void 0,i=void 0){l(this,g,{writable:!0,value:{}}),l(this,f,{writable:!0,value:{}}),(0,u.Z)(this,"add",((t,e,i)=>((0,h.Z)(this,g)[t]||((0,h.Z)(this,g)[t]=[]),(0,h.Z)(this,g)[t].push(e),i&&((0,h.Z)(this,f)[t]||((0,h.Z)(this,f)[t]=[]),(0,h.Z)(this,f)[t].push(i)),this))),(0,u.Z)(this,"hasErrors",(()=>this.getErrorCodes().length>0)),(0,u.Z)(this,"getErrorCodes",(()=>Object.keys((0,h.Z)(this,g)))),(0,u.Z)(this,"getErrorCode",(()=>this.getErrorCodes()[0])),(0,u.Z)(this,"getErrorMessages",((t=void 0)=>{if(t)return(0,h.Z)(this,g)[t];const e=[];for(const t in(0,h.Z)(this,g))(0,h.Z)(this,g).hasOwnProperty(t)&&e.concat((0,h.Z)(this,g)[t]);return e})),(0,u.Z)(this,"getErrorMessage",((t=void 0)=>(t=t||this.getErrorCode(),this.getErrorMessages(t)[0]))),(0,u.Z)(this,"getErrorData",((t=void 0)=>(t=t||this.getErrorCode(),(0,h.Z)(this,f)[t]))),(0,u.Z)(this,"getAllErrorMessages",(()=>{const t=[];for(const e in(0,h.Z)(this,g))(0,h.Z)(this,g).hasOwnProperty(e)&&t.push(...(0,h.Z)(this,g)[e]);return t})),t&&(e&&((0,h.Z)(this,g)[t]=[e]),i&&((0,h.Z)(this,f)[t]=i))}static fromPHPObject(t){const e=new p;return(0,d.Z)(e,g,t.errors),(0,d.Z)(e,f,t.error_data),e}static fromApiError(t){const e=new p;if((0,h.Z)(e,g)[t.code]=[t.message],(0,h.Z)(e,f)[t.code]=[t.data],t.additional_errors)for(const i of t.additional_errors)(0,h.Z)(e,g)[i.code]=[i.message],i.data&&((0,h.Z)(e,f)||(0,d.Z)(e,f,[]),(0,h.Z)(e,f)[i.code].push(i.data));return e}}class m extends Error{constructor(t,...e){super(t.message||(0,a.__)("An unknown error occurred.","better-wp-security"),...e),Error.captureStackTrace&&Error.captureStackTrace(this,m),this.__response=t;for(const e in t)t.hasOwnProperty(e)&&Object.defineProperty(this,e,{value:t[e],configurable:!0,enumerable:!0,writable:!0})}toString(){return this.__response.toString()}getResponse(){return this.__response}}class I{constructor(t,e,i,n=[],r=[],s=[]){(0,u.Z)(this,"type",void 0),(0,u.Z)(this,"error",void 0),(0,u.Z)(this,"data",void 0),(0,u.Z)(this,"success",void 0),(0,u.Z)(this,"info",void 0),(0,u.Z)(this,"warning",void 0),this.type=t,this.error=e,this.data=i,this.success=n,this.info=r,this.warning=s,Object.seal(this)}isSuccess(){return this.type===I.SUCCESS}static async fromResponse(t){const e=e=>{const i=t.headers?.get(`X-Messages-${e}`);return i?JSON.parse(i):[]},i=204!==t.status&&t.json?await t.json():null,n=H(i),r=n.hasErrors()?I.ERROR:I.SUCCESS,s=e("Success"),o=e("Info"),c=e("Warning");return new I(r,n,i,s,o,c)}}Object.defineProperty(I,"SUCCESS",{value:"success",writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(I,"ERROR",{value:"error",writable:!1,enumerable:!1,configurable:!1});const y=(0,o.createContext)({getUrl(t,e){t="settings"===t?"itsec":"itsec-"+t;const i=(0,c.removeQueryArgs)(document.location.href,...Object.keys((0,c.getQueryArgs)(document.location.href)));return(0,c.addQueryArgs)(i,e?{page:t,path:e}:{page:t})}});function E(t,e){const{getUrl:i}=(0,o.useContext)(y);return i(t,e)}function _(t){if(t<=999)return t.toString();if(t<=9999){const e=(t/1e3).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","k"):`${e}k`}if(t<=99999)return t.toString().substring(0,2)+"k";if(t<=999999)return t.toString().substring(0,3)+"k";if(t<=9999999){const e=(t/1e6).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","m"):`${e}m`}if(t<=99999999)return t.toString().substring(0,2)+"m";if(t<=999999999)return t.toString().substring(0,3)+"m";if(t<=9999999999){const e=(t/1e9).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","b"):`${e}b`}return t}function T(t){if(!(0,n.isPlainObject)(t))return!1;const e=Object.keys(t);return 2===e.length&&e.includes("errors")&&e.includes("error_data")}function A(t){if(!(0,n.isPlainObject)(t))return!1;const e=Object.keys(t);return(3===e.length||4===e.length)&&!(4===e.length&&!e.includes("additional_errors"))&&e.includes("code")&&e.includes("message")&&e.includes("data")}function H(t){return t instanceof p?t:T(t)?p.fromPHPObject(t):A(t)?p.fromApiError(t):new p}function O(t){const e={};for(const[i,n]of t)e[i]=n;return e}function b(t,e){const i=[[],[]];for(const n of t)i[e(n)?0:1].push(n);return i}function v(t){if(t instanceof Error)throw t;throw new m(t)}const C="https://secure.gravatar.com/avatar/d7a973c7dab26985da5f961be7b74480?s=96&d=mm&f=y&r=g";function N(t,e,i=!0){return(0,n.get)(t,["_links","self",0,"targetHints",e],i?void 0:[])}function w(t){return S(t,"self")}function S(t,e){return(0,n.get)(t,["_links",e,0,"href"])}function Z(t,e){if(t&&t.links)for(const i of t.links)if(i.rel===e)return i}function U(t,e){if("object"!==t.type)return t;let i;for(const r in e)e.hasOwnProperty(r)&&"hidden"===e[r]["ui:widget"]&&(i||(i=(0,n.cloneDeep)(t)),delete i.properties[r]);return i||t}function M(t){let e=[];if(!t)return e;const i=t instanceof p?t:H((0,n.pick)(t,["code","message","data"]));return"rest_invalid_param"===i.getErrorCode()&&(e=Object.values(i.getErrorData().params)),[...i.getAllErrorMessages(),...e]}function P(t){const e=new Date;if(t>e)return(0,a.__)("Online Recently","better-wp-security");const i=Math.floor((e-t)/1e3);let n=i/31536e3;return n>1?(0,a.sprintf)((0,a.__)("%s years","better-wp-security"),Math.floor(n)):(n=i/2592e3,n>1?(0,a.sprintf)((0,a.__)("%s months","better-wp-security"),Math.floor(n)):(n=i/86400,n>1?(0,a.sprintf)((0,a.__)("%s days","better-wp-security"),Math.floor(n)):(n=i/3600,n>1?(0,a.sprintf)((0,a.__)("%s hours","better-wp-security"),Math.floor(n)):(n=i/60,n>1?(0,a.sprintf)((0,a.__)("%s minutes","better-wp-security"),Math.floor(n)):(0,a.sprintf)((0,a.__)("%s seconds","better-wp-security"),Math.floor(n))))))}function D(){return D.instance||(D.instance=new(s())({schemaId:"id"}),D.instance.addMetaSchema(i(27171)),D.instance.addFormat("html",{type:"string",validate:()=>!0}),D.instance.addFormat("relative-file-path",{type:"string",validate:t=>!t.includes("../")}),D.instance.addFormat("file-path",{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")}),D.instance.addFormat("directory",{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")})),D.instance}function F(t){const e=t.toUpperCase().split("").map((t=>127397+t.charCodeAt()));return String.fromCodePoint(...e)}},87514:t=>{t.exports=function(){return this.wp.apiFetch}()},48015:t=>{t.exports=function(){return this.wp.data}()},6293:t=>{t.exports=function(){return this.wp.element}()},54761:t=>{t.exports=function(){return this.wp.hooks}()},95122:t=>{t.exports=function(){return this.wp.i18n}()},73470:t=>{t.exports=function(){return this.wp.url}()},92819:t=>{"use strict";t.exports=window.lodash},71002:(t,e,i)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}i.d(e,{Z:()=>n})}},t=>{t.O(0,[5307],(()=>(76864,t(t.s=76864))));var e=t.O();((window.itsec=window.itsec||{}).core=window.itsec.core||{})["admin-notices-api"]=e}]);